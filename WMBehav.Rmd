---
title             : "Working memory capacity in a change detection task is affected by the number of irrelevant objects in the display"
shorttitle        : "Effects of distractor number on change detection"

author: 
  - name          : "Dion T. Henare"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "School of Psychology, University of Auckland, Private Bag 92019, Auckland 1010, New Zealand"
    email         : "dion.henare@auckland.ac.nz"
  - name          : "Paul M. Corballis"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "School of Psychology, Univeristy of Auckland"

author_note: |
  School of Psychology, University of Auckland, Private Bag 92019, Auckland 1010, New Zealand

abstract: |
  Enter abstract here. Each new line herein must be indented, like this line.
  
keywords          : "working memory capacity, change detection, delayed matching to sample, distraction, filtering"
wordcount         : "X"

bibliography      : ["r-references.bib"]

figsintext        : no
figurelist        : no
tablelist         : no
footnotelist      : no
lineno            : no
mask              : no

class             : "man"
output            : papaja::apa6_pdf
---

\raggedbottom

```{r WMB_load_packages, include = FALSE}
library("papaja")
#library(plyr)
library(dplyr)
library(ggplot2)
library(afex)
library(knitr)
library(xtable)
library(caTools) #split-half data
```

```{r WMB_helper_functions, include=FALSE, echo=FALSE}
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
    library(plyr)

    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function (x, na.rm=FALSE) {
        if (na.rm) sum(!is.na(x))
        else       length(x)
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- ddply(data, groupvars, .drop=.drop,
      .fun = function(xx, col) {
        c(N    = length2(xx[[col]], na.rm=na.rm),
          mean = mean   (xx[[col]], na.rm=na.rm),
          sd   = sd     (xx[[col]], na.rm=na.rm)
        )
      },
      measurevar
    )

    # Rename the "mean" column    
    datac <- rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval: 
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval/2 + .5, datac$N-1)
    datac$ci <- datac$se * ciMult

    return(datac)
}
```

```{r load_raw_data, incude = FALSE, echo=FALSE}
#Find all files
filePath <- "P:/dhen061/WMBehav-RawFolder/data/"
files <- list.files(path = filePath, pattern = ".csv")
#load the first one and get the variable names
allData <- read.csv(file=paste(filePath,files[1], sep=""), header=TRUE, sep=",")
demoData <- subset(allData, select = c(X2..Age,X1..Sex))
demoData$X1..Sex <- as.character(demoData$X1..Sex)
allData <- subset(allData, select = c(targetColour, DistNum, matchType, targetNum, CorrAns, key_resp_2.keys, key_resp_2.rt))
#delete data so we just have a dataframe with the relevant variables
allData <- allData[0,]
demoData <- demoData[0,]
#set PID to 1
pid = 1

#Loop through the files, load them , and if there are 720 (as should be the case), add the PID and append to dataframe
for (file in files){
  curData <- read.csv(file=paste(filePath,file, sep=""), header=TRUE, sep=",")
  curData <- filter(curData,  !is.na(curData$trials.thisRepN))
  curDemo <- subset(curData, select = c(X2..Age,X1..Sex))
  curDemo$X1..Sex <- as.character(curDemo$X1..Sex)
  curData <- subset(curData, select = c(targetColour, DistNum, matchType, targetNum, CorrAns, key_resp_2.keys, key_resp_2.rt))
  if (nrow(curData) == 720) {
    curData$PID <- pid
    curDemo$PID <- pid
    allData <- rbind(allData,curData)
    demoData <- rbind(demoData,curDemo[1,])
    pid = pid+1
  } else {
    #If file doesn't have 720 rows, print the name
    #print(file)
  }
}
```

```{r tidy_data, include = FALSE}
#Tidy the data, remove non-response trials, and calculate correct response column
allData <- filter(allData, !allData$key_resp_2.keys=="None")
allData$CorrAns <- factor(allData$CorrAns)
allData$key_resp_2.keys <- factor(allData$key_resp_2.keys)
allData$correctResponse <- as.integer(allData$CorrAns==allData$key_resp_2.keys)
#Spit half the data
sample = sample.split(allData$correctResponse, SplitRatio = 0.5)
odd = subset(allData, sample == TRUE)
even = subset(allData, sample == FALSE)

#Participant rejection
participants <- group_by(allData,PID)
numberOfTrials <- dplyr::summarise(participants, nrow=NROW(correctResponse))
#Which participants have less than 700 trials meaning over 20 non-responses
nonRespFails <- numberOfTrials$PID[numberOfTrials$nrow<695]
if (!is.null(nonRespFails)) {
#remove failed participants
for (subj in 1:length(nonRespFails)) {
  allData <- allData[!allData$PID==nonRespFails[subj],]
  demoData <- demoData[!demoData$PID==nonRespFails[subj],]
  odd <- odd[!odd$PID==nonRespFails[subj],]
  even <- even[!even$PID==nonRespFails[subj],]
}
}
#Which participnats have <60% accuracy in 2 targ 0 dist condition
easyCond <- filter(allData, targetNum==2 & DistNum==0)
easyAccuracy <- dplyr::summarise(group_by(easyCond,PID), avg=mean(correctResponse))
accuracyFails <- easyAccuracy$PID[easyAccuracy$avg<0.60]
if (!is.null(accuracyFails)) {
for (subj in 1:length(accuracyFails)) {
  allData <- allData[!allData$PID==accuracyFails[subj],]
  demoData <- demoData[!demoData$PID==accuracyFails[subj],]
  odd <- odd[!odd$PID==accuracyFails[subj],]
  even <- even[!even$PID==accuracyFails[subj],]
}
}
```

```{r create_measure, include = FALSE}
#Create hits column and FA column
allData$hits <- as.integer(allData$CorrAns=="m" & allData$key_resp_2.keys=="m")
allData$FA <- as.integer(allData$CorrAns=="x" & allData$key_resp_2.keys=="m")
odd$hits <- as.integer(odd$CorrAns=="m" & odd$key_resp_2.keys=="m")
odd$FA <- as.integer(odd$CorrAns=="x" & odd$key_resp_2.keys=="m")
even$hits <- as.integer(even$CorrAns=="m" & even$key_resp_2.keys=="m")
even$FA <- as.integer(even$CorrAns=="x" & even$key_resp_2.keys=="m")
allData$numDist <- as.numeric(as.character(allData$DistNum))
allData$numDist[allData$DistNum=="targEqual"]=allData$targetNum[allData$DistNum=="targEqual"]
allData$numDist[allData$DistNum=="targOpp"]=8-allData$targetNum[allData$DistNum=="targOpp"]
fixData <- subset(allData, DistNum!="targEqual" & DistNum!="targOpp")
pid=1
model <- summary(glm(correctResponse~targetNum+numDist,data=subset(fixData,PID==pid),family=binomial()))

#Create summary table
participants <- group_by(allData, PID, targetNum, DistNum)
#Get number of hits and false alarms and calculate pashlers K
#Apply loglinear approach to prevent Hit rate and FA rate of 1 or 0 (Hautus,1995)
summaryTable <- dplyr::summarise(participants, correctResponse=mean(correctResponse)*100, hits=sum(hits)+0.5, fa=sum(FA)+0.5, possHits=sum(as.integer(CorrAns=="m"))+1, possFA=sum(as.integer(CorrAns=="x"))+1)
summaryTable$hitProp <- summaryTable$hits/summaryTable$possHits
summaryTable$faProp <- summaryTable$fa/summaryTable$possFA
#calculate capacity pashlers K
summaryTable$cowanC <- summaryTable$targetNum*(summaryTable$hitProp-summaryTable$faProp)
#calculate d and c
summaryTable$zHit <- qnorm(summaryTable$hitProp)
summaryTable$zFA <- qnorm(summaryTable$faProp)
summaryTable$D <- summaryTable$zHit-summaryTable$zFA
summaryTable$C <- -((summaryTable$zHit+summaryTable$zFA)/2)

#Add group information
grouping <- subset(summaryTable,DistNum==0)
grouping$Group <- ifelse(grouping$cowanC<=median(grouping$cowanC),"Low","High")
for (subj in c(1:nrow(grouping))) {
  summaryTable$Group[summaryTable$PID==grouping$PID[subj]] <- grouping$Group[subj]
}

#Repeat calculations for split half data
oddParticipants <- group_by(odd,PID, targetNum,DistNum)
oddTable <- dplyr::summarise(oddParticipants, correctResponse=mean(correctResponse)*100, hits=sum(hits)+0.5, fa=sum(FA)+0.5, possHits=sum(as.integer(CorrAns=="m"))+1, possFA=sum(as.integer(CorrAns=="x"))+1)
oddTable$hitProp <- oddTable$hits/oddTable$possHits
oddTable$faProp <- oddTable$fa/oddTable$possFA
oddTable$cowanC <- oddTable$targetNum*(oddTable$hitProp-oddTable$faProp)

evenParticipants <- group_by(even,PID, targetNum,DistNum)
evenTable <- dplyr::summarise(evenParticipants, correctResponse=mean(correctResponse)*100, hits=sum(hits)+0.5, fa=sum(FA)+0.5, possHits=sum(as.integer(CorrAns=="m"))+1, possFA=sum(as.integer(CorrAns=="x"))+1)
evenTable$hitProp <- evenTable$hits/evenTable$possHits
evenTable$faProp <- evenTable$fa/evenTable$possFA
evenTable$cowanC <- evenTable$targetNum*(evenTable$hitProp-evenTable$faProp)

#Separate fixed and variable blocks
fixNames <- c("0", "2","4","6")
fixed.Vals <- filter(summaryTable, DistNum %in% fixNames)
varNames <- c("targEqual","targOpp")
var.Vals <- filter(summaryTable, DistNum %in% varNames)
var.Vals$numDist <- ifelse(var.Vals$DistNum=="targEqual",var.Vals$targetNum,8-var.Vals$targetNum)
var.Vals$Block <- var.Vals$DistNum
#fix up factors in fix v var mat
fixVmat.Vals <- filter(summaryTable, DistNum == "targEqual" | (DistNum=="2" & targetNum==2) | (DistNum=="4" & targetNum==4)  | (DistNum=="6" & targetNum==6))
fixVmat.Vals$numDist <- fixVmat.Vals$DistNum
fixVmat.Vals$numDist[fixVmat.Vals$DistNum=="targEqual"] <- fixVmat.Vals$targetNum[fixVmat.Vals$DistNum=="targEqual"]
fixVmat.Vals$Block <- fixVmat.Vals$DistNum
levels(fixVmat.Vals$Block) <- c(levels(fixVmat.Vals$Block),"fixed")
fixVmat.Vals$Block[fixVmat.Vals$Block!="targEqual"] <- "fixed"
fixVmat.Vals$Block <- factor(fixVmat.Vals$Block)
fixVmat.Vals$numDist <- factor(fixVmat.Vals$numDist)
#Fix up factors in fix v var opp
fixVopp.Vals <- filter(summaryTable, DistNum == "targOpp" | (DistNum=="2" & targetNum==6) | (DistNum=="4" & targetNum==4)  | (DistNum=="6" & targetNum==2))
fixVopp.Vals$numDist <- fixVopp.Vals$DistNum
fixVopp.Vals$numDist[fixVopp.Vals$DistNum=="targOpp"] <- 8-fixVopp.Vals$targetNum[fixVopp.Vals$DistNum=="targOpp"]
fixVopp.Vals$Block <- fixVopp.Vals$DistNum
levels(fixVopp.Vals$Block) <- c(levels(fixVopp.Vals$Block),"fixed")
fixVopp.Vals$Block[fixVopp.Vals$Block!="targOpp"] <- 'fixed'
fixVopp.Vals$Block <- factor(fixVopp.Vals$Block)
```

# Introduction

Working memory is a term used to describe the active maintenance of information for brief periods of time. It is well known that there are limits to the amount of information that can be stored, and that an individual's working memory capacity is associated with a range of other important cognitive abilities. Individuals with larger working memory capacities have been shown to have better language comprehension [@daneman_working_1996], problem solving, multi-tasking [@hambrick_predictors_2010], emotion regulation  [@kleider_shooting_2010], and higher general fluid intelligence [@kane_working_2005]. Working memory capacity has also been shown to predict real-world abilities such as hazard detection in drivers [@wood_working_2016]. The estimation of working memory capacity is therefore increasingly important for research in all of these cognitive domains, and recent evidence has shown that capacity estimates can vary depending not only on the general paradigm being used, but the details of that paradigm [@shipstead_mechanisms_2014].

Change detection tasks are an increasingly popular way of measuring visual working memory capacity across individuals. Change detection involves the brief presentation of an encoding display, where a number of simple objects are shown on screen for the participant to encode. This is followed by a delay period where the participant must maintain the encoded information in working memory, and then a retrieval probe is presented. The participant must indicate whether or not the retrieval probe matches the encoded stimuli. Typically, set size (the number of objects that should be encoded) is varied across trials and performance is measured using either accuracy on the task, or by estimating capacity [@rouder_how_2011]. Capacity is quantified for a given set size based on the proportion of hits (the number of correctly identified match probes), and the proportion of false alarms (the number of non-matches that are misidentified as matches) [@rouder_how_2011]. As a result of their short, simple structure, change detection tasks are well suited to use with developmental and clinical populations, as well as with neural recordings that require large trial numbers [@xu_reliability_2018]. Change detection tasks also translate well to paradigms used with non-human animals and taken together, these features have contributed to their rising popularity [@xu_reliability_2018].

Specific incarnations of the change detection paradigm can vary significantly in terms of the type of stimuli used, and the number of stimuli that are presented at both encoding and retrieval. Historically, one of the main ways that change detection tasks have varied is with regard to the number of probes presented on the retrieval display. In the single-probed retrieval version of the task, participants are shown only one of the encoded stimuli and must therefore indicate whether that specific object has changed in any way. In the whole-display retrieval version of the task however, the entire set of encoded stimuli are presented as probes and the participant must indicate whether any one of the stimuli have changed. Another way in which the task varies is with regard to the number of encode stimuli that need to be remembered. In some versions of the task, all of the objects presented during encoding must be remembered by the participant. In other versions of the task participants receive a cue ahead of the encoding display which indicates which subset of the encoding stimuli needs to be remembered. For example, participants may be cued to encode only the blue objects in an upcoming display which contains both blue and red stimuli. These features have been shown to effect not just the absolute capacity values reported, but the underlying cognitive mechanisms that are being tested.

One set of cognitive mechanisms that is especially important to consider when measuring working memory is selective attention. Converging evidence from both within and between-participant experiments now suggests that there is significant functional overlap between selective attention and working memory. When working memory load on an individual is increased, performance on a concurrent visual search task is impeded. Similarly, individuals who naturally possess a larger working memory capacity perform better on standard measures of attentional control like the Stroop task and the Eriksen flanker task. Modern accounts of working memory availability typically recognise this close association between attention and working memory by either incorporating elements of attentional control, or in some cases suggesting that attentional control is the primary determinant of working memory capacity. More specific investigations of this relationship using both behavioural and neural measures now suggest that it is specifically the ability to disengage from irrelevant distractors which differentiates high and low capacity individuals.

The critical role that distractor suppression plays in working memory performance raises questions around the effect that irrelevant objects may have in a change detection task. In our study, we used a cued, probed-retrieval version of the change detection task while varying the number of distractors across blocks. This allowed us to measure the effect that distraction in the change detection task has on both participant accuracy, and estimates of individual capacity. Set size varied within each block however the number of distractors remained fixed in 4 conditions (ranging from 0 distractors to 6 distractors), and varied in two conditions (either to maintain the total number of objects on screen across the block, or to match the number of targets on each trial). We measured the effect of these distractor conditions on accuracy and capacity, as well as on the hit rate, false alarm rate, sensitivity (D'), and criterion (C).

Woring memory is central to functioning and important for stuff like fluid intelligence, attention, IQ or whatever.

change detection tasks are popular for measuring WM capacity across individuals. (basic outline, increasing popularity, benefits).

Many variations in change detection tasks. Pashler vs Cowan.

working memory related to attention and specificaly distractor filtering things.

Estimates of capacity may be effected by the number of distractors that are presented in the change detection task - our study.

trial-to-trial context effets working memory so distractor effect may also be mediated by context - our study.

# Methods

## Participants
```{r demo_Analysis, echo=FALSE, include=FALSE}
demographics <- group_by(demoData,PID, X2..Age, X1..Sex)
#Get number of hits and false alarms and calculate pashlers K
#Apply loglinear approach to prevent Hit rate and FA rate of 1 or 0 (Hautus,1995)
demoTable <- dplyr::summarise(demographics)
demoTable$X1..Sex <- toupper(substr(demoTable$X1..Sex,start=1,stop=1))
demoTable$X2..Age <- as.numeric(substr(demoTable$X2..Age,start=1,stop=2))
demoTable$SexBin <- ifelse(demoTable$X1..Sex=="F",1,0)

meanAge <- mean(demoTable$X2..Age)
sdAge <- sd(demoTable$X2..Age)
minAge <- min(demoTable$X2..Age)
maxAge <- max(demoTable$X2..Age)

totalSubj <- length(summary(as.factor(demoTable$PID)))
totalFemale <- sum(demoTable$SexBin)
```

62 individuals participated in the task and all had either normal or corrected-to-normal vision. One participant did not complete the entire task and was therefore excluded from analysis. Five participants were deemed not to have performed the task properly (3 had over 25 non-responses, and two had less than 60% accuracy on the easiest condition where the set size was 2 and there were no distractors on screen). As a result, 56 individuals (`r totalFemale` female) with an age range of `r minAge` to `r maxAge` (mean = `r meanAge` and sd = `r sdAge`) were included in the analysis.

## Change detection task

Participants were positioned 57cm away from the screen and performed two practice blocks of 12 trials each, followed by 18 blocks of 40 trials each for a total of 720 experimental trials. For each block, the participant was told which colour (either blue or red) they would be focusing on for that block. Trials began with a 1 second fixation cross and involved being presented with a set of rectangles for 250ms, some of which matched the target colour, and some of which were irrelevant coloured distractors. Participants were required to encode only the subset of objects defined by the target colour, maintain that information across a one second delay period, and were then presented with the retrieval display for 2 seconds (or until the participant responded). The retrieval display consisted of all of the stimuli presented in the encoding display however one of the target objects was marked with a probe and participants were required to indicate whether the probed object had changed since encoding. The probe object was rotated randomly on 50% of trials (constituting a non-match trial) and matched the encoded object on the other 50% of trials. A fixation cross was maintained in the centre of the screen throughout the entire trial.

Blocks were separated into 6 different conditions. In four of the blocks, the number of distractors (objects of the irrelevant colour) present at encoding and retrieval was fixed across the block at either 0, 2, 4, or 6. In the other two conditions, distractor number varied within the block. In one of these variable conditions, the number of distractors was simply the same as the number of targets on a given trial. In the other variable block, we sought to keep the total number of objects on screen the same, and therefore the number of distractors was always the inverse of the number of targets.

## Stimulus presentation

All stimuli were presented on a .X. monitor in  using psychopy (v.). The fixation cross0 .5x0.5 degrees and was fixed in the centre of the screen throughout each trial. Each memory stimulus was a 0.5X2 degree bar of either red() or green() and rotated to one of four orientations  (0,45,90,135). The probe consisted of a 0.5x0.5 white square positioned on the centre of the probed stimulus. All stimuli were kept within .X. degrees of the fixation cross and were separated by at least .X. degrees. Python code used to run the task is available at .X.link.

## Data processing
Trials which had no response were removed for all participants and performance measures were calculated for each block type and set size. For each of these conditions we calculated accuracy, capacity, hit rate, false alarm rate, D', and C.
groups created by...

# Results
## Fixed distractor blocks
### Accuracy
```{r accuracy_fixedonly_targets, include=FALSE, echo=FALSE}
accuracy.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
accuracy.fixedonly.targanddist.targXdist <- pairs(emmeans(accuracy.fixedonly.targanddist.aov, ~ targetNum|DistNum))
accuracy.fixedonly.targanddist.distXtarg <- pairs(emmeans(accuracy.fixedonly.targanddist.aov, ~ DistNum|targetNum))

#Create tables
accuracy.fixedonly.targanddist.table <- apa_print(accuracy.fixedonly.targanddist.aov)
# FPairwise tables
accuracy.fixedonly.targanddist.distXtarg.table <- xtable(summary(accuracy.fixedonly.targanddist.distXtarg), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracyfixedonlytarganddistdistXtargTable")
accuracy.fixedonly.targanddist.targXdist.table <- xtable(summary(accuracy.fixedonly.targanddist.targXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracyfixedonlytarganddisttargXdistTable")

#Create plot
accuracy.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="correctResponse", groupvars=c("targetNum","DistNum"))
accuracy.targXdist.bar <- ggplot(accuracy.targXdist.summarydata, aes( x=DistNum,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Accuracy (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracytargXdistPlot.pdf", width = 7, paper = "special")
accuracy.targXdist.bar
dev.off()
```

A 3x4 repeated measures ANOVA was performed in order to test the effect of target number (two, four, and six), and distractor number (zero, two four, and six) on accuracy across blocks where the number of distractors was fixed. The results show a main effect of target number (`r accuracy.fixedonly.targanddist.table$full_result$targetNum`) and distractor number (`r accuracy.fixedonly.targanddist.table$full_result$DistNum`). There was also a significant interaction between target number and distractor number (`r accuracy.fixedonly.targanddist.table$full_result$targetNum_DistNum`) and pairwise comparisons using Tukey correction were performed in order to follow up this effect. For a target number of two, there were no significant differences in accuracy between distractor conditions (see table\ \@ref(tab:accuracyfixedonlytarganddistdistXtargTable)). For a target number of four, accuracy is significantly higher in the zero distractor condition than the four distractor, and six distractor conditions, but there are no other significant difference sbetween distractor conditions. For a target number of six, accuracy is significantly higher in the zero distractor condition than the four distractor and six distractor condition, and also significantly higher in the two distractor condition than the four distractor conditions (see table\ \@ref(tab:accuracyfixedonlytarganddistdistXtargTable) for a full summary). For each distractor level (zero, two four and six distractrs), participants were significantly more accurate in the two target condition than the 4 target or six target condition, and more accurate in the 4 target than 6 target condition. The only exception to this was the zero distractor condition where there was no significant difference between the two and four target conditions (see table\ \@ref(tab:accuracyfixedonlytarganddisttargXdistTable) . The results of this analysis are displayed in figure\ \@ref(fig:accuracytargXdistPlot).

```{r accuracy_fixedonly_targanddist_table, results = 'asis'}
#apa_table(accuracy.fixedonly.targanddist.table$table, caption = "Fixed accuracy. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant accuracy in the working memory task.", escape = FALSE)
```

```{r accuracy_fixedOnly_pairwise, results = 'asis'}
print(accuracy.fixedonly.targanddist.targXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(accuracy.fixedonly.targanddist.distXtarg.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r accuracytargXdistPlot, fig.cap = "Participant accuracy as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracytargXdistPlot.pdf", auto_pdf = TRUE)
```

### Capacity
```{r capacity_fixedonly_targets, include=FALSE, echo=FALSE}
capacity.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "cowanC",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
capacity.fixedonly.targanddist.targXdist <- pairs(emmeans(capacity.fixedonly.targanddist.aov, ~ targetNum|DistNum))
capacity.fixedonly.targanddist.distXtarg <- pairs(emmeans(capacity.fixedonly.targanddist.aov, ~ DistNum|targetNum))

#Create tables
capacity.fixedonly.targanddist.table <- apa_print(capacity.fixedonly.targanddist.aov)
# FPairwise tables
capacity.fixedonly.targanddist.distXtarg.table <- xtable(summary(capacity.fixedonly.targanddist.distXtarg), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacityfixedonlytarganddistdistXtargTable")
capacity.fixedonly.targanddist.targXdist.table <- xtable(summary(capacity.fixedonly.targanddist.targXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacityfixedonlytarganddisttargXdistTable")

#Create plot
capacity.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="cowanC", groupvars=c("targetNum","DistNum"))
capacity.targXdist.bar <- ggplot(capacity.targXdist.summarydata, aes( x=DistNum,y=cowanC)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=cowanC-se, ymax=cowanC+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Capacity (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacitytargXdistPlot.pdf", width = 7, paper = "special")
capacity.targXdist.bar
dev.off()
```

A 3x4 repeated measures ANOVA was performed in order to test the effect of target number (two, four, and six), and distractor number (zero, two four, and six) on accuracy across blocks where the number of distractors was fixed. The results show a main effect of target number (`r capacity.fixedonly.targanddist.table$full_result$targetNum`) and distractor number (`r capacity.fixedonly.targanddist.table$full_result$DistNum`). There was also a significant interaction between target number and distractor number (`r capacity.fixedonly.targanddist.table$full_result$targetNum_DistNum`) and pairwise comparisons using Tukey correction were performed in order to follow up this effect. For a target number of two, there were no significant differences in accuracy between distractor conditions (see table\ \@ref(tab:capacityfixedonlytarganddistdistXtargTable)). For a target number of four, capacity estimates were significantly higher in the zero distractor condition than the four and six distractor conditions but no other comparisons were significant. For a target number of six, capacity estimates were significantly higher in the zero distractor condition than the four and six distractor conditions, and capacity was also higher in the two distractor condition than the four distractor conditions. There were no other significant interactions (see table\ \@ref(tab:capacityfixedonlytarganddistdistXtargTable)). The effects of target number are uninformative but conform with the expectation that capacity estimates increase as set size increases but asymptote once set size is sufficiently large for capturing average capacity, for full results see table\ \@ref(tab:capacityfixedonlytarganddisttargXdistTable). The results of this analysis are displayed in figure\ \@ref(fig:capacitytargXdistPlot).

```{r capacity_fixedonly_targanddist_table, results = 'asis'}
#apa_table(capacity.fixedonly.targanddist.table$table, caption = "fixed capacity. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant capacity in the working memory task.", escape = FALSE)
```

```{r capacity_fixedOnly_pairwise, results = 'asis'}
print(capacity.fixedonly.targanddist.targXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(capacity.fixedonly.targanddist.distXtarg.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r capacitytargXdistPlot, fig.cap = "Participant capacity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacitytargXdistPlot.pdf", auto_pdf = TRUE)
```

### Hits
```{r hits_fixedonly_targets, include=FALSE, echo=FALSE}
hits.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "hitProp",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
hits.fixedonly.targanddist.targXdist <- pairs(emmeans(hits.fixedonly.targanddist.aov, ~ targetNum|DistNum))
hits.fixedonly.targanddist.distXtarg <- pairs(emmeans(hits.fixedonly.targanddist.aov, ~ DistNum|targetNum))

#Create tables
hits.fixedonly.targanddist.table <- apa_print(hits.fixedonly.targanddist.aov)
# FPairwise tables
hits.fixedonly.targanddist.targXdist.table <- xtable(summary(hits.fixedonly.targanddist.targXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixedonly.targanddist.targXdist.Table")
hits.fixedonly.targanddist.distXtarg.table <- xtable(summary(hits.fixedonly.targanddist.distXtarg), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixedonly.targanddist.distXtarg.Table")

#Create plot
hits.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="hitProp", groupvars=c("targetNum","DistNum"))
hits.targXdist.bar <- ggplot(hits.targXdist.summarydata, aes( x=DistNum,y=hitProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=hitProp-se, ymax=hitProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Hits (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitstargXdistPlot.pdf", width = 7, paper = "special")
hits.targXdist.bar
dev.off()
```



```{r hits_fixedonly_targanddist_table, results = 'asis'}
#apa_table(hits.fixedonly.targanddist.table$table, caption = "Fixed hits. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant hits in the working memory task.", escape = FALSE)
```

```{r hits_fixedOnly_pairwise, results = 'asis'}
#print(hits.fixedonly.targanddist.targXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
#print(hits.fixedonly.targanddist.distXtarg.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r hitstargXdistPlot, fig.cap = "Participant hits as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
#include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitstargXdistPlot.pdf", auto_pdf = TRUE)
```

### False alarms
```{r fa_fixedonly_targets, include=FALSE, echo=FALSE}
fa.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "faProp",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
fa.fixedOnly.targets.targmain <- pairs(emmeans(fa.fixedonly.targanddist.aov, ~targetNum))

#Create tables
fa.fixedOnly.targets.table <- apa_print(fa.fixedonly.targanddist.aov)
#Create pairwise tables
fa.fixedOnly.targets.targmain.table <- xtable(summary(fa.fixedOnly.targets.targmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (fa)", label = "tab:fa.fixedOnly.targets.targmain.table")

#Create plot
fa.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="faProp", groupvars=c("targetNum","DistNum"))
fa.targXdist.bar <- ggplot(fa.targXdist.summarydata, aes( x=DistNum,y=faProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=faProp-se, ymax=faProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Fa (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fatargXdistPlot.pdf", width = 7, paper = "special")
fa.targXdist.bar
dev.off()
```

```{r fa.fixedOnly.targets.table, results = 'asis'}
#apa_table(fa.fixedOnly.targets.table$table, caption = "Fixed FA. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant fa in the working memory task.", escape = FALSE)
```

```{r fa_fixedOnly_pairwise, results = 'asis'}
#print(fa.fixedOnly.targets.targmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r fatargXdistPlot, fig.cap = "Participant fa as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
#include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fatargXdistPlot.pdf", auto_pdf = TRUE)
```

### Sensitivity
```{r sensitivity_fixedOnly, include=FALSE, echo=FALSE}
sensitivity.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "D",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
sensitivity.fixedonly.targanddist.targXdist <- pairs(emmeans(sensitivity.fixedonly.targanddist.aov, ~ targetNum|DistNum))
sensitivity.fixedonly.targanddist.distXtarg <- pairs(emmeans(sensitivity.fixedonly.targanddist.aov, ~ DistNum|targetNum))

#Create tables
sensitivity.fixedonly.targanddist.table <- apa_print(sensitivity.fixedonly.targanddist.aov)
# FPairwise tables
sensitivity.fixedonly.targanddist.distXtarg.table <- xtable(summary(sensitivity.fixedonly.targanddist.distXtarg), caption = "Summary of the pairwise comparisons used to follow up the main interaction (sensitivity)", label = "tab:sensitivityfixedonlytarganddistdistXtargTable")
sensitivity.fixedonly.targanddist.targXdist.table <- xtable(summary(sensitivity.fixedonly.targanddist.targXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (sensitivity)", label = "tab:sensitivityfixedonlytarganddisttargXdistTable")

#Create plot
sensitivity.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="D", groupvars=c("targetNum", "DistNum"))
sensitivity.targXdist.bar <- ggplot(sensitivity.targXdist.summarydata, aes( x=DistNum,y=D)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=D-se, ymax=D+se), size=0.5,
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Sensitivity (D')",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_sensitivitytargXdistPlot.pdf", width = 7, paper = "special")
sensitivity.targXdist.bar
dev.off()
```

A 3x4 repeated measures ANOVA was performed in order to test the effect of target number (two, four, and six), and distractor number (zero, two four, and six) on sensitivity (d') across blocks where the number of distractors was fixed. The results show a main effect of target number (`r sensitivity.fixedonly.targanddist.table$full_result$targetNum`) and distractor number (`r sensitivity.fixedonly.targanddist.table$full_result$DistNum`). There was also a significant interaction between target number and distractor number (`r sensitivity.fixedonly.targanddist.table$full_result$targetNum_DistNum`) and pairwise comparisons using Tukey correction were performed in order to follow up this effect. For a target number of two, there were no significant differences in accuracy between distractor conditions (see table\ \@ref(tab:sensitivityfixedonlytarganddistdistXtargTable)). For a target number of four, sensitivity estimates were significantly higher in the zero distractor condition than the four and six distractor conditions but no other comparisons were significant. For a target number of six, sensitivity estimates were significantly higher in the zero distractor condition than the four and six distractor conditions, and sensitivity was also higher in the two distractor condition than the four distractor conditions. There were no other significant interactions (see table\ \@ref(tab:sensitivityfixedonlytarganddistdistXtargTable)). For every level of distractor number sensitivity was higher in for two targets than for four or six, and higherfor four targets than six targets, for full results see table\ \@ref(tab:sensitivityfixedonlytarganddisttargXdistTable). The results of this analysis are displayed in figure\ \@ref(fig:sensitivitytargXdistPlot).

```{r sensitivity_fixedonly_targanddist_table, results = 'asis'}
#apa_table(sensitivity.fixedonly.targanddist.table$table, caption = "Fixed sensitivity. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant accuracy in the working memory task.", escape = FALSE)
```

```{r sensitivity_fixedOnly_pairwise, results = 'asis'}
print(sensitivity.fixedonly.targanddist.targXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(sensitivity.fixedonly.targanddist.distXtarg.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r sensitivitytargXdistPlot, fig.cap = "Participant sensitivity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_sensitivitytargXdistPlot.pdf", auto_pdf = TRUE)
```
### Response bias
```{r criterion_fixedOnly, include=FALSE, echo=FALSE}
criterion.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "C",
  id = "PID",
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
criterion.fixedonly.targanddist.targXdist <- pairs(emmeans(criterion.fixedonly.targanddist.aov, ~ targetNum|DistNum))
criterion.fixedonly.targanddist.distXtarg <- pairs(emmeans(criterion.fixedonly.targanddist.aov, ~ DistNum|targetNum))

#Create tables
criterion.fixedonly.targanddist.table <- apa_print(criterion.fixedonly.targanddist.aov)

#Create plot
criterion.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="C", groupvars=c("targetNum","DistNum"))
criterion.targXdist.bar <- ggplot(criterion.targXdist.summarydata, aes( x=DistNum,y=C)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=C-se, ymax=C+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Response bias (C)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_criteriontargXdistPlot.pdf", width = 7, paper = "special")
criterion.targXdist.bar
dev.off()
```

A 3x4 repeated measures ANOVA was performed in order to test the effect of target number (two, four, and six), and distractor number (zero, two four, and six) on response bias (C) across blocks where the number of distractors was fixed. The results showed no significant main effect of either target number (`r criterion.fixedonly.targanddist.table$full_result$targetNum`) or distractor number (`r criterion.fixedonly.targanddist.table$full_result$DistNum`). There was also no significant interaction between the two (`r criterion.fixedonly.targanddist.table$full_result$targetNum_DistNum`). The results of this analysis are shown in figure\ \@ref(fig:criteriontargXdistPlot).

````{r criterion_fixedonly_targanddist_table, results = 'asis'}
#apa_table(criterion.fixedonly.targanddist.table$table, caption = "Fixed criterion. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant accuracy in the working memory task.", escape = FALSE)
```

```{r criteriontargXdistPlot, fig.cap = "Participant criterion as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_criteriontargXdistPlot.pdf", auto_pdf = TRUE)
```

## Fixed vs. targEqual
### Accuracy
```{r accuracy_fixVmat_distractors, include=FALSE, echo=FALSE}
accuracy.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
accuracy.fixVmatch.distractors.distXblock <- pairs(emmeans(accuracy.fixVmatch.distractors.aov, ~ numDist|Block))
accuracy.fixVmatch.distractors.blockXdist <- pairs(emmeans(accuracy.fixVmatch.distractors.aov, ~ Block|numDist))

#Create tables
accuracy.fixVmatch.distractors.table <- apa_print(accuracy.fixVmatch.distractors.aov)
#Create pairwise tables
accuracy.fixVmatch.distractors.distXblock.table <- xtable(summary(accuracy.fixVmatch.distractors.distXblock), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracy.fixVmatch.distractors.distXblock.table")
accuracy.fixVmatch.distractors.blockXdist.table <- xtable(summary(accuracy.fixVmatch.distractors.blockXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracy.fixVmatch.distractors.blockXdist.table")

#Create plots
accuracy.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="correctResponse", groupvars=c("Block","numDist"))
accuracy.fixVmat.bar <- ggplot(accuracy.fixVmat.summarydata, aes( x=Block,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Accuracy (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracyfixvmatPlot.pdf", width = 7, paper = "special")
accuracy.fixVmat.bar
dev.off()
```

Interaction between block and distnum. For targEqual, 2>4>6. For fixed, 2>4>6. For dist 2, targEqual<fixed, for targ 4, targEqual=fixed, for targ 6, targEqual=fixed. Figure\ \@ref(fig:accuracyfixVmatPlot)

```{r accuracy_fixVmatch_distractors_table, results = 'asis'}
apa_table(accuracy.fixVmatch.distractors.table$table, caption = "FixVMat accuracy: Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant accuracy in the working memory task.", escape = FALSE)
```

```{r accuracy_fixVmat_pairwise, results = 'asis'}
print(accuracy.fixVmatch.distractors.distXblock.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(accuracy.fixVmatch.distractors.blockXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r accuracyfixVmatPlot, fig.cap = "Participant accuracy as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracyfixVmatPlot.pdf", auto_pdf = TRUE)
```
### Capacity
```{r capacity_fixVmat_distractors, include=FALSE, echo=FALSE}
capacity.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "cowanC",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
capacity.fixVmatch.distractors.distXblock <- pairs(emmeans(capacity.fixVmatch.distractors.aov, ~ numDist|Block))
capacity.fixVmatch.distractors.blockXdist <- pairs(emmeans(capacity.fixVmatch.distractors.aov, ~ Block|numDist))

#Create tables
capacity.fixVmatch.distractors.table <- apa_print(capacity.fixVmatch.distractors.aov)
#Create pairwise tables
capacity.fixVmatch.distractors.distXblock.table <- xtable(summary(capacity.fixVmatch.distractors.distXblock), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacity.fixVmatch.distractors.distXblock.table")
capacity.fixVmatch.distractors.blockXdist.table <- xtable(summary(capacity.fixVmatch.distractors.blockXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacity.fixVmatch.distractors.blockXdist.table")

#Create plots
capacity.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="cowanC", groupvars=c("Block","numDist"))
capacity.fixVmat.bar <- ggplot(capacity.fixVmat.summarydata, aes( x=Block,y=cowanC)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=cowanC-se, ymax=cowanC+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Capacity (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacityfixvmatPlot.pdf", width = 7, paper = "special")
capacity.fixVmat.bar
dev.off()
```

Interaction between block and distnum. For targequal, d2<d4<d6. For fixed, d2<d4, d2<d6, d4=d6. for d2, blocks=. for d4 blocks=. for d6, var>fixed. Figure\ \@ref(fig:capacityfixVmatPlot)

```{r capacity_fixVmatch_distractors_table, results = 'asis'}
apa_table(capacity.fixVmatch.distractors.table$table, caption = "FixVMat capacity. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant capacity in the working memory task.", escape = FALSE)
```

```{r capacity_fixVmat_pairwise, results = 'asis'}
print(capacity.fixVmatch.distractors.distXblock.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(capacity.fixVmatch.distractors.blockXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r capacityfixVmatPlot, fig.cap = "Participant capacity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacityfixVmatPlot.pdf", auto_pdf = TRUE)
```
### Hits
```{r hits_fixVmat_distractors, include=FALSE, echo=FALSE}
hits.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "hitProp",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
hits.fixVmatch.distractors.distXblock <- pairs(emmeans(hits.fixVmatch.distractors.aov, ~ numDist|Block))
hits.fixVmatch.distractors.blockXdist <- pairs(emmeans(hits.fixVmatch.distractors.aov, ~ Block|numDist))

#Create tables
hits.fixVmatch.distractors.table <- apa_print(hits.fixVmatch.distractors.aov)
#Create pairwise tables
hits.fixVmatch.distractors.distXblock.table <- xtable(summary(hits.fixVmatch.distractors.distXblock), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixVmatch.distractors.distXblock.table")
hits.fixVmatch.distractors.blockXdist.table <- xtable(summary(hits.fixVmatch.distractors.blockXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixVmatch.distractors.blockXdist.table")

#Create plots
hits.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="hitProp", groupvars=c("Block","numDist"))
hits.fixVmat.bar <- ggplot(hits.fixVmat.summarydata, aes( x=Block,y=hitProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=hitProp-se, ymax=hitProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Hits (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitsfixvmatPlot.pdf", width = 7, paper = "special")
hits.fixVmat.bar
dev.off()
```

Approaching interaction (0.059) between dist num and block. If followed up, for targequa, 2>4>6, for fixed, 2>4>6. For dist2, no block diff, for dist 4, approaching block effect, for dist 6, targequal>fixed.  Figure\ \@ref(fig:hitsfixVmatPlot)

```{r hits_fixVmatch_distractors_table, results = 'asis'}
apa_table(hits.fixVmatch.distractors.table$table, caption = "FixVMat hits. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant hits in the working memory task.", escape = FALSE)
```

```{r hits_fixVmat_pairwise, results = 'asis'}
print(hits.fixVmatch.distractors.distXblock.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(hits.fixVmatch.distractors.blockXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r hitsfixVmatPlot, fig.cap = "Participant hits as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitsfixVmatPlot.pdf", auto_pdf = TRUE)
```
### False alarms
```{r fa_fixVmat_distractors, include=FALSE, echo=FALSE}
fa.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "faProp",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
fa.fixVmatch.distractors.distmain <- pairs(emmeans(fa.fixVmatch.distractors.aov, ~ numDist))

#Create tables
fa.fixVmatch.distractors.table <- apa_print(fa.fixVmatch.distractors.aov)
#Create pairwise tables
fa.fixVmatch.distractors.distmain.table <- xtable(summary(fa.fixVmatch.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (fa)", label = "tab:fa.fixVmatch.distractors.distmain.table")

#Create plots
fa.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="faProp", groupvars=c("Block","numDist"))
fa.fixVmat.bar <- ggplot(fa.fixVmat.summarydata, aes( x=Block,y=faProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=faProp-se, ymax=faProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Fa (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fafixvmatPlot.pdf", width = 7, paper = "special")
fa.fixVmat.bar
dev.off()
```

Main effect of numdist. 2<4<6. Figure\ \@ref(fig:fafixVmatPlot)

```{r fa_fixVmatch_distractors_table, results = 'asis'}
apa_table(fa.fixVmatch.distractors.table$table, caption = "FixVMat FA. Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant fa in the working memory task.", escape = FALSE)
```

```{r fa_fixVmat_pairwise, results = 'asis'}
print(fa.fixVmatch.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r fafixVmatPlot, fig.cap = "Participant fa as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fafixVmatPlot.pdf", auto_pdf = TRUE)
```
### Sensitivity
```{r sensitivity_fixVmat_distractors, include=FALSE, echo=FALSE}
sensitivity.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "D",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
sensitivity.fixVmatch.distractors.distXblock <- pairs(emmeans(sensitivity.fixVmatch.distractors.aov, ~ numDist|Block))
sensitivity.fixVmatch.distractors.blockXdist <- pairs(emmeans(sensitivity.fixVmatch.distractors.aov, ~ Block|numDist))

#Create tables
sensitivity.fixVmatch.distractors.table <- apa_print(sensitivity.fixVmatch.distractors.aov)
#Create pairwise tables
sensitivity.fixVmatch.distractors.distXblock.table <- xtable(summary(sensitivity.fixVmatch.distractors.distXblock), caption = "Summary of the pairwise comparisons used to follow up the main interaction (sensitivity)", label = "tab:sensitivity.fixVmatch.distractors.distXblock.table")
sensitivity.fixVmatch.distractors.blockXdist.table <- xtable(summary(sensitivity.fixVmatch.distractors.blockXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (sensitivity)", label = "tab:sensitivity.fixVmatch.distractors.blockXdist.table")

#Create plots
sensitivity.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="correctResponse", groupvars=c("Block","numDist"))
sensitivity.fixVmat.bar <- ggplot(sensitivity.fixVmat.summarydata, aes( x=Block,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
                width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("sensitivity (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_sensitivityfixvmatPlot.pdf", width = 7, paper = "special")
sensitivity.fixVmat.bar
dev.off()
```

Figure\ \@ref(fig:sensitivityfixVmatPlot)

```{r sensitivity_fixVmatch_distractors_table, results = 'asis'}
apa_table(sensitivity.fixVmatch.distractors.table$table, caption = "FixVMat sensitivity: Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant sensitivity in the working memory task.", escape = FALSE)
```

```{r sensitivity_fixVmat_pairwise, results = 'asis'}
print(sensitivity.fixVmatch.distractors.distXblock.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(sensitivity.fixVmatch.distractors.blockXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r sensitivityfixVmatPlot, fig.cap = "Participant sensitivity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_sensitivityfixVmatPlot.pdf", auto_pdf = TRUE)
```
### Response bias
```{r criterion_fixVmat_distractors, include=FALSE, echo=FALSE}
criterion.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "C",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
criterion.fixVmatch.distractors.distXblock <- pairs(emmeans(criterion.fixVmatch.distractors.aov, ~ numDist|Block))
criterion.fixVmatch.distractors.blockXdist <- pairs(emmeans(criterion.fixVmatch.distractors.aov, ~ Block|numDist))

#Create tables
criterion.fixVmatch.distractors.table <- apa_print(criterion.fixVmatch.distractors.aov)

#Create plots
criterion.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="correctResponse", groupvars=c("Block","numDist"))
criterion.fixVmat.bar <- ggplot(criterion.fixVmat.summarydata, aes( x=Block,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
                width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("criterion (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_criterionfixvmatPlot.pdf", width = 7, paper = "special")
criterion.fixVmat.bar
dev.off()
```

No effects. Figure\ \@ref(fig:criterionfixVmatPlot)

```{r criterion_fixVmatch_distractors_table, results = 'asis'}
apa_table(criterion.fixVmatch.distractors.table$table, caption = "FixVMat criterion: Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant criterion in the working memory task.", escape = FALSE)
```

```{r criterionfixVmatPlot, fig.cap = "Participant criterion as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_criterionfixVmatPlot.pdf", auto_pdf = TRUE)
```
## Fixed vs. targOpp
### Accuracy
```{r accuracy_fixVopp_distractors, include=FALSE, echo=FALSE}
accuracy.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
accuracy.fixVopp.distractors.distmain <- pairs(emmeans(accuracy.fixVopp.distractors.aov, ~ numDist))

#create table
accuracy.fixVopp.distractors.table <- apa_print(accuracy.fixVopp.distractors.aov)
#Create followup table
accuracy.fixVopp.distractors.distmain.table <- xtable(summary(accuracy.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracy.fixVopp.distractors.distmain.table")

#create plot
accuracy.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="correctResponse", groupvars=c("Block","numDist"))
accuracy.fixVopp.bar <- ggplot(accuracy.fixVopp.summarydata, aes( x=Block,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Accuracy (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracyfixvoppPlot.pdf", width = 7, paper = "special")
accuracy.fixVopp.bar
dev.off()
```

Main effect of distnum, as distnum increases accuracy goes up 2<4<6 (because set size is going down). Figure\ \@ref(fig:accuracyfixVoppPlot)

```{r accuracy_fixVopp_distractors_table, results = 'asis'}
apa_table(accuracy.fixVopp.distractors.table$table, caption = "FixVOpp accuracy. Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant accuracy in the working memory task.", escape = FALSE)
```

```{r accuracy_fixVopp_pairwise, results = 'asis'}
print(accuracy.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r accuracyfixVoppPlot, fig.cap = "Participant accuracy as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracyfixVoppPlot.pdf", auto_pdf = TRUE)
```
### Capacity
```{r capacity_fixVopp_distractors, include=FALSE, echo=FALSE}
capacity.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "cowanC",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
capacity.fixVopp.distractors.distmain <- pairs(emmeans(capacity.fixVopp.distractors.aov, ~ numDist))

#create table
capacity.fixVopp.distractors.table <- apa_print(capacity.fixVopp.distractors.aov)
#Create followup table
capacity.fixVopp.distractors.distmain.table <- xtable(summary(capacity.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacity.fixVopp.distractors.distmain.table")

#create plot
capacity.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="cowanC", groupvars=c("Block","numDist"))
capacity.fixVopp.bar <- ggplot(capacity.fixVopp.summarydata, aes( x=Block,y=cowanC)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=cowanC-se, ymax=cowanC+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Capacity (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacityfixvoppPlot.pdf", width = 7, paper = "special")
capacity.fixVopp.bar
dev.off()
```

Main effect of distnum, 2>4>6 . Figure\ \@ref(fig:capacityfixVoppPlot)

```{r capacity_fixVopp_distractors_table, results = 'asis'}
apa_table(capacity.fixVopp.distractors.table$table, caption = "FixVOpp capacity. Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant capacity in the working memory task.", escape = FALSE)
```

```{r capacity_fixVopp_pairwise, results = 'asis'}
print(capacity.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r capacityfixVoppPlot, fig.cap = "Participant capacity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacityfixVoppPlot.pdf", auto_pdf = TRUE)
```

### Hits
```{r hits_fixVopp_distractors, include=FALSE, echo=FALSE}
hits.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "hitProp",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
hits.fixVopp.distractors.distmain <- pairs(emmeans(hits.fixVopp.distractors.aov, ~ numDist))

#create table
hits.fixVopp.distractors.table <- apa_print(hits.fixVopp.distractors.aov)
#Create followup table
hits.fixVopp.distractors.distmain.table <- xtable(summary(hits.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixVopp.distractors.distmain.table")

#create plot
hits.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="hitProp", groupvars=c("Block","numDist"))
hits.fixVopp.bar <- ggplot(hits.fixVopp.summarydata, aes( x=Block,y=hitProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=hitProp-se, ymax=hitProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Hits (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitsfixvoppPlot.pdf", width = 7, paper = "special")
hits.fixVopp.bar
dev.off()
```

Main effect of distnum, as distnum increases hits goes up 2=4, 2<6, 4<6 (because set size is going down). Figure\ \@ref(fig:hitsfixVoppPlot)

```{r hits_fixVopp_distractors_table, results = 'asis'}
apa_table(hits.fixVopp.distractors.table$table, caption = "FixVOpp hits. Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant hits in the working memory task.", escape = FALSE)
```

```{r hits_fixVopp_pairwise, results = 'asis'}
print(hits.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r hitsfixVoppPlot, fig.cap = "Participant hits as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitsfixVoppPlot.pdf", auto_pdf = TRUE)
```
### False alarms
```{r fa_fixVopp_distractors, include=FALSE, echo=FALSE}
fa.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "faProp",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
fa.fixVopp.distractors.distmain <- pairs(emmeans(fa.fixVopp.distractors.aov, ~ numDist))

#create table
fa.fixVopp.distractors.table <- apa_print(fa.fixVopp.distractors.aov)
#Create followup table
fa.fixVopp.distractors.distmain.table <- xtable(summary(fa.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (fa)", label = "tab:fa.fixVopp.distractors.distmain.table")

#create plot
fa.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="faProp", groupvars=c("Block","numDist"))
fa.fixVopp.bar <- ggplot(fa.fixVopp.summarydata, aes( x=Block,y=faProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=faProp-se, ymax=faProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Fa (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fafixvoppPlot.pdf", width = 7, paper = "special")
fa.fixVopp.bar
dev.off()
```

Main effect of distnum, as distnum increases fa goes up 2>4>6 (because set size is going down). Figure\ \@ref(fig:fafixVoppPlot)

```{r fa_fixVopp_distractors_table, results = 'asis'}
apa_table(fa.fixVopp.distractors.table$table, caption = "FixVOpp FA. Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant fa in the working memory task.", escape = FALSE)
```

```{r fa_fixVopp_pairwise, results = 'asis'}
print(fa.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r fafixVoppPlot, fig.cap = "Participant fa as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fafixVoppPlot.pdf", auto_pdf = TRUE)
```
### Sensitivity
```{r sensitivity_fixVopp_distractors, include=FALSE, echo=FALSE}
sensitivity.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "D",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
sensitivity.fixVopp.distractors.distmain <- pairs(emmeans(sensitivity.fixVopp.distractors.aov, ~ numDist))

#create table
sensitivity.fixVopp.distractors.table <- apa_print(sensitivity.fixVopp.distractors.aov)
#Create followup table
sensitivity.fixVopp.distractors.distmain.table <- xtable(summary(sensitivity.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (sensitivity)", label = "tab:sensitivity.fixVopp.distractors.distmain.table")

#create plot
sensitivity.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="correctResponse", groupvars=c("Block","numDist"))
sensitivity.fixVopp.bar <- ggplot(sensitivity.fixVopp.summarydata, aes( x=Block,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
                width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("sensitivity (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_sensitivityfixvoppPlot.pdf", width = 7, paper = "special")
sensitivity.fixVopp.bar
dev.off()
```

Main effect of DistNum. 2>4>6 Figure\ \@ref(fig:sensitivityfixVoppPlot)

```{r sensitivity_fixVopp_distractors_table, results = 'asis'}
apa_table(sensitivity.fixVopp.distractors.table$table, caption = "FixVOpp sensitivity. Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant sensitivity in the working memory task.", escape = FALSE)
```

```{r sensitivity_fixVopp_pairwise, results = 'asis'}
print(sensitivity.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r sensitivityfixVoppPlot, fig.cap = "Participant sensitivity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_sensitivityfixVoppPlot.pdf", auto_pdf = TRUE)
```
### Response bias
```{r criterion_fixVopp_distractors, include=FALSE, echo=FALSE}
criterion.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "C",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
criterion.fixVopp.distractors.distmain <- pairs(emmeans(criterion.fixVopp.distractors.aov, ~ numDist))

#create table
criterion.fixVopp.distractors.table <- apa_print(criterion.fixVopp.distractors.aov)

#create plot
criterion.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="correctResponse", groupvars=c("Block","numDist"))
criterion.fixVopp.bar <- ggplot(criterion.fixVopp.summarydata, aes( x=Block,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
                width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("criterion (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_criterionfixvoppPlot.pdf", width = 7, paper = "special")
criterion.fixVopp.bar
dev.off()
```

No effects. Figure\ \@ref(fig:criterionfixVoppPlot)

```{r criterion_fixVopp_distractors_table, results = 'asis'}
apa_table(criterion.fixVopp.distractors.table$table, caption = "FixVOpp criterion. Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant criterion in the working memory task.", escape = FALSE)
```

```{r criterion_fixVopp_pairwise, results = 'asis'}
#print(criterion.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r criterionfixVoppPlot, fig.cap = "Participant criterion as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_criterionfixVoppPlot.pdf", auto_pdf = TRUE)
```
## Individual differences Analyses

In order to test for the effects of working memory capacity on filtering in our task, we followed the analysis used by Miller and Unsworth (2018). Individual differences in working memory capacity and filtering.

### Reliability
```{r reliability,echo=FALSE,include=FALSE}
#Greate Group
extractGroupData <- subset(fixed.Vals,DistNum==0)
groupDataSummary <- dplyr::summarise(group_by(extractGroupData, PID),capacity=mean(cowanC))
for (subj in unique(fixed.Vals$PID)) {
  fixed.Vals$avgCapacity[fixed.Vals$PID==subj] <- groupDataSummary$capacity[groupDataSummary$PID==subj]
  var.Vals$avgCapacity[var.Vals$PID==subj] <- groupDataSummary$capacity[groupDataSummary$PID==subj]
  
  fixVopp.Vals$avgCapacity[fixVopp.Vals$PID==subj] <- groupDataSummary$capacity[groupDataSummary$PID==subj]
  fixVmat.Vals$avgCapacity[fixVmat.Vals$PID==subj] <- groupDataSummary$capacity[groupDataSummary$PID==subj]
}

evenGroupData <- subset(evenTable,DistNum==0)
evenDataSummary <- dplyr::summarise(group_by(evenGroupData, PID),capacity=mean(cowanC))
for (subj in unique(evenTable$PID)) {
  evenTable$avgCapacity[evenTable$PID==subj] <- evenDataSummary$capacity[evenDataSummary$PID==subj]
}

oddGroupData <- subset(oddTable,DistNum==0)
oddDataSummary <- dplyr::summarise(group_by(oddGroupData, PID),capacity=mean(cowanC))
for (subj in unique(oddTable$PID)) {
  oddTable$avgCapacity[oddTable$PID==subj] <- oddDataSummary$capacity[oddDataSummary$PID==subj]
}

oddReliable <- summarise(group_by(oddTable,PID),cap = mean(avgCapacity))
evenReliable <- summarise(group_by(evenTable,PID),cap = mean(avgCapacity))

oddVeven.cor <- cor(oddReliable$cap, evenReliable$cap)
```

We tested the internal reliability of the capacity measure (cowan's C by performing a correlation on capacity measured from odd and even trials. The results show an r of `r as.character(oddVeven.cor)`.

### Fixed distractor blocks

```{r measuringDistractorEffectInFixed}
#"First, we examined the correlation between the filtering cost described above and WM span."
zeroDist <- subset(fixed.Vals, DistNum==0)
nonZeroDist <- subset(fixed.Vals, DistNum!=0)
zeroDist<- dplyr::summarise(group_by(zeroDist,PID),accuracy=mean(correctResponse))
nonZeroDist<- dplyr::summarise(group_by(nonZeroDist,PID),accuracy=mean(correctResponse))
for (subj in unique(allData$PID)) {
  fixed.Vals$distDiff[fixed.Vals$PID==subj] <- zeroDist$accuracy[zeroDist$PID==subj]-nonZeroDist$accuracy[nonZeroDist$PID==subj]
}
testCorrel <- dplyr::summarise(group_by(fixed.Vals,PID),cap = mean(avgCapacity), dist=mean(distDiff))
corValue <- cor(testCorrel$cap,testCorrel$dist)
corValuep <- cor.test(testCorrel$cap,testCorrel$dist)
corPlot <- ggplot(data=fixed.Vals,aes(x=distDiff,y=avgCapacity)) +geom_point()+geom_smooth(method=lm) +theme_apa()

#"In our next analysis, we entered WM span as a covariate into the ANOVA described above."
accuracy.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("targetNum","DistNum"),
  covariate = "avgCapacity"
)

#"Next, we used regression to estimate shared variance btween filtering and nonfiltering trials. Presumably he shared variance between distractor-absent (nonfiltering) and distractor-present (filtering" trials represents any demands on storage capacity and control processes that are common to all trial types. After controlling for this shared variance, any residual shared variance between WM span and distractor-present trials should be due to WM-related control abilities that are unique to these trials."
twoDist <- subset(fixed.Vals, DistNum==2)
twoDist <- dplyr::summarise(group_by(twoDist,PID),accuracy=mean(correctResponse))
fourDist <- subset(fixed.Vals, DistNum==4)
fourDist <- dplyr::summarise(group_by(fourDist,PID),accuracy=mean(correctResponse))
sixDist <- subset(fixed.Vals, DistNum==6)
sixDist <- dplyr::summarise(group_by(sixDist,PID),accuracy=mean(correctResponse))

fixedRegressSheet <- data.frame(PID=zeroDist$PID,zeroDist=zeroDist$accuracy,twoDist=twoDist$accuracy,fourDist=fourDist$accuracy,sixDist=sixDist$accuracy)
fixedRegressSheet$Capacity <- dplyr::summarise(group_by(subset(fixed.Vals, DistNum==0),PID),cap = mean(avgCapacity))$cap
fixedModel1 <- lm(sixDist~zeroDist,fixedRegressSheet)
fixedModel2 <- lm(sixDist~zeroDist+twoDist,fixedRegressSheet)
fixedModel3 <- lm(sixDist~zeroDist+twoDist+fourDist,fixedRegressSheet)
fixedRegression <- anova(fixedModel1,fixedModel2,fixedModel3)


resid1 <- resid(fixedModel1)
ggplot(fixedRegressSheet, aes(x=twoDist, y=resid1)) + geom_point() +geom_smooth(method=lm) +theme_apa()
resid2 <- resid(fixedModel2)
ggplot(fixedRegressSheet, aes(x=fourDist, y=resid2)) + geom_point() +geom_smooth(method=lm) +theme_apa()

#Plot the part correlation of capacity after accounting for fixNZ accuracy
fixedRegressSheet$m1Residual <- resid(fixedModel1)
ggplot(fixedRegressSheet, aes(x=Capacity, y=m1Residual)) + geom_point() +geom_smooth(method=lm) +theme_apa()

if (FALSE) {
#R value across nonZero dist condition
nonZeroDist <- subset(fixed.Vals, DistNum!=0)
for (subj in unique(nonZeroDist$PID)) {
  fixed.Vals$nonZeroR[fixed.Vals$PID==subj] <- summary(lm(correctResponse ~ numOfDist, subset(nonZeroDist, PID==subj)))$coefficients[2]
}
testCorrel <- summarise(group_by(fixed.Vals,PID),acc = mean(correctResponse),cap = mean(avgCapacity), dist=mean(nonZeroR))
corValue <-cor(testCorrel$cap,testCorrel$dist)
corValuep <- cor.test(testCorrel$cap,testCorrel$dist)
corPlot <- ggplot(data=testCorrel,aes(x=dist,y=cap)) +geom_point()

#GLM per person using dist num to predict correct response
for (subj in unique(allData$PID)) {
  result <- summary(glm(correctResponse~numDist+targetNum,data=subset(allData,PID==subj),family=binomial()))
  fixed.Vals$distGLMR[fixed.Vals$PID==subj] <- result$coefficients[2]
}
testCorrel <- summarise(group_by(fixed.Vals,PID),cap = mean(avgCapacity), dist=mean(distGLMR))
corValue <-  cor(testCorrel$cap,testCorrel$dist)
corValuep <-  cor.test(testCorrel$cap,testCorrel$dist)
corPlot <- ggplot(data=fixed.Vals,aes(x=distGLMR,y=avgCapacity)) +geom_point()

#Regression for each person of distNum and capacity

#hierarchical regression, exetra variance explained by dist present trials


}
```

### TargEqual block
```{r measuringDistractorEffectIntargEqual}
#Because distractor number and target number are conflated, we can't calculate filter cost like above, so we skip that analysis and jst do the other two.
#First, repeat ANOVAs from above including WM capacity as a covariate.
aov_ez(
  data = fixVmat.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("numDist", "Block"),
  covariate = "avgCapacity"
)

#After accounting for shared variance between fixed and variable accuracy, can capacity predict some variance in var block accuracy
fixzeroDist <- subset(fixed.Vals, DistNum==0)
fixzeroDist<- dplyr::summarise(group_by(fixzeroDist,PID),accuracy=mean(correctResponse))
fixnonZDist <- subset(fixed.Vals, DistNum==targetNum)
fixnonZDist<- dplyr::summarise(group_by(fixnonZDist,PID),accuracy=mean(correctResponse))
varnonZeroDist <- subset(var.Vals, DistNum=="targEqual")
varnonZeroDist<- dplyr::summarise(group_by(varnonZeroDist,PID),accuracy=mean(correctResponse))

regressSheet <- data.frame(PID=fixzeroDist$PID)
regressSheet$fixZ <- fixzeroDist$accuracy
regressSheet$fixNZ <- fixnonZDist$accuracy
regressSheet$varAcc <- varnonZeroDist$accuracy
regressSheet$Capacity <- dplyr::summarise(group_by(subset(fixed.Vals, DistNum==0),PID),cap = mean(avgCapacity))$cap

model1 <- lm(varAcc ~fixNZ,regressSheet)
model2 <- lm(varAcc ~fixNZ+Capacity,regressSheet)
hRegression <- anova(model1,model2)
#Plot the part correlation of capacity after accounting for fixNZ accuracy
regressSheet$m1Residual <-residual <- resid(model1)
ggplot(regressSheet, aes(x=Capacity, y=m1Residual)) + geom_point() +geom_smooth(method=lm) +theme_apa()
```

### TargOpp block
```{r measuringDistractorEffectIntargOpp}
#Because distractor number and target number are conflated, we can't calculate filter cost like above, so we skip that analysis and jst do the other two.
#First, repeat ANOVAs from above including WM capacity as a covariate.
aov_ez(
  data = fixVopp.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("numDist", "Block"),
  covariate = "avgCapacity"
)

#After accounting for shared variance between fixed and variable accuracy, can capacity predict some variance in var block accuracy?
fixnonZDist <- subset(fixed.Vals, DistNum==8-targetNum)
fixnonZDist<- dplyr::summarise(group_by(fixnonZDist,PID),accuracy=mean(correctResponse))
varnonZeroDist <- subset(var.Vals, DistNum=="targOpp")
varnonZeroDist<- dplyr::summarise(group_by(varnonZeroDist,PID),accuracy=mean(correctResponse))

regressSheet <- data.frame(PID=fixnonZDist$PID)
regressSheet$fixNZ <- fixnonZDist$accuracy
regressSheet$varAcc <- varnonZeroDist$accuracy
regressSheet$Capacity <- dplyr::summarise(group_by(subset(fixed.Vals, DistNum==4|DistNum==6),PID),cap = mean(avgCapacity))$cap

model1 <- lm(varAcc ~fixNZ,regressSheet)
model2 <- lm(varAcc ~fixNZ+Capacity,regressSheet)
hRegression <- anova(model1,model2)
#Plot the part correlation of capacity after accounting for fixNZ accuracy
regressSheet$m1Residual <-residual <- resid(model1)
ggplot(regressSheet, aes(x=Capacity, y=m1Residual)) + geom_point() +geom_smooth(method=lm) +theme_apa()
```

```{r jackKnife}
if (FALSE) {
p1 <- subset(allData, DistNum!="targEqual" & DistNum != "targOpp")
p1$numOfDist <- as.integer(as.character(p1$DistNum))
p1  <- subset(odd, DistNum!="targEqual" & DistNum != "targOpp")
p1$numOfDist <- as.integer(as.character(p1$DistNum))
p1  <- subset(even, DistNum!="targEqual" & DistNum != "targOpp")
p1$numOfDist <- as.integer(as.character(p1$DistNum))

#calculate all measures
for (row in 1:nrow(p1)) {
  #Extract jack knifed subset for current trial (all matching trials except itself)
  curSub <- subset(p1,PID==p1$PID[row] & targetNum == p1$targetNum[row] & numOfDist == p1$numOfDist[row] & rownames(p1)!=rownames(p1[row,]))
  
  #Calculate SD measures for subset
  p1$jsetSize[row] <- p1$targetNum[row]
  p1$jhits[row] <- sum(curSub$hits)+0.5
  p1$jfa[row] <- sum(curSub$FA) + 0.5
  p1$jpossHits[row] <- sum(as.integer(curSub$CorrAns=="m"))+1
  p1$jpossFA[row]=sum(as.integer(curSub$CorrAns=="x"))+1
  p1$jhitProp[row] <- p1$jhits[row]/p1$jpossHits[row]
  p1$jfaProp[row] <- p1$jfa[row]/p1$jpossFA[row]
  p1$jackCapacity[row] <- p1$setSize[row]*(p1$jhitProp[row]-p1$jfaProp[row])
  
  #Save jack knifed capacity estimate to current row of original data
  #p1$jackCapacity[row] <- jackCapacity
}
p1$jackCapacity <- p1$jsetSize*(p1$jhitProp-p1$jfaProp)

summary(lm(jackCapacity ~ numOfDist, p1))
#Rum GLM for each participant and save their r value for distractor number and capacity in  rValue
rValue <- vector()
for (row in 1:length(unique(p1$PID))) {
  pid <- unique(p1$PID)[row]
  model <- summary(glm(jackCapacity~targetNum+numOfDist,data=subset(p1,PID==pid),family=gaussian()))
  rValue[row] <-model$coefficients[3,1]
}
cor(subset(fixed.Vals,targetNum==6&DistNum==0)$cowanC,rValue)
scatter.smooth(subset(fixed.Vals,targetNum==6&DistNum==0)$cowanC,rValue)

#Check if jackKnife estimates are the same as regular estimates
jackCheck <- group_by(p1, PID, targetNum, DistNum)
jackTable <- dplyr::summarise(jackCheck, cap =mean(jackCapacity))
regCheck <- group_by(fixed.Vals,PID,targetNum,DistNum)
regTable <- dplyr::summarise(regCheck, cap =mean(cowanC))
regTable$jackCapacity <- jackTable$cap
regTable$diff <- regTable$jackCapacity-regTable$cap

histData <- dplyr::summarise(group_by(regTable, PID), diff=mean(diff))
plot <- as.numeric(histData$diff)
hist(plot)

oddJack <- group_by(oddp1, PID, targetNum, DistNum)
oddJackTable <- dplyr::summarise(oddJack, cap=mean(jackCapacity))
evenJack <- group_by(evenp1, PID, targetNum, DistNum)
evenJackTable <- dplyr::summarise(evenJack, cap=mean(jackCapacity))
allJack <- group_by(allp1, PID, targetNum, DistNum)
allJackTable <- dplyr::summarise(allJack, cap=mean(jackCapacity))

oddCheck <- dplyr::summarise(group_by(subset(oddJackTable,targetNum==4 | targetNum==6), PID),cap=mean(cap))
evenCheck <- dplyr::summarise(group_by(subset(evenJackTable,targetNum==4 | targetNum==6), PID),cap=mean(cap))
allCheck <- dplyr::summarise(group_by(subset(allJackTable,targetNum==4 | targetNum==6), PID),cap=mean(cap))

capacity.fixedonly.targanddist.aov <- aov_ez(
  data = jackTable,
  dv = "cap",
  id = "PID",
  within = c("targetNum","DistNum")
)
capacity.targXdist.summarydata <- summarySE(jackTable, measurevar="cap", groupvars=c("targetNum","DistNum"))
jack.bar <- ggplot(capacity.targXdist.summarydata, aes( x=DistNum,y=cap)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=cap-se, ymax=cap+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Capacity (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()

capacity.targXdist.summarydata <- summarySE(regTable, measurevar="cap", groupvars=c("targetNum","DistNum"))
reg.bar <- ggplot(capacity.targXdist.summarydata, aes( x=DistNum,y=cap)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=cap-se, ymax=cap+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Capacity (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
}
```

### Accuracy
```{r capacity_groups_fixed}
 if (FALSE) {
fixed.Vals$totalObj <- fixed.Vals$targetNum + fixed.Vals$numOfDist
summary(lm(cowanC ~ numOfDist, fixed.Vals))
ggplot(fixed.Vals, aes(x=numOfDist, y=cowanC)) +
  geom_point()

#p1 <- subset(allData, PID==27)
p1 <- subset(allData, DistNum!="targEqual" & DistNum != "targOpp")
p1$numOfDist <- as.integer(as.character(p1$DistNum))
summary(glm(correctResponse~targetNum+numOfDist,data=p1,family=binomial()))
ggplot(p1, aes(x=numOfDist, y=correctResponse, color=correctResponse)) +
  geom_col() +
  facet_grid(correctResponse.~numOfDist)

capacity.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "D",
  id = "PID",
  within = c("targetNum","DistNum"),
  between = "Group"
)


lowGroup <- subset(fixed.Vals, Group=="Low")
highGroup <- subset(fixed.Vals, Group=="High")
setTwo <- subset(fixed.Vals, targetNum==2)
setFour <- subset(fixed.Vals, targetNum=4)
setSix <- subset(fixed.Vals, targetNum==6)

setTwoANOVA <- aov_ez(
  data = setTwo,
  dv = "cowanC",
  id = "PID",
  within = "DistNum",
  between = "Group"
)

setFourANOVA <- aov_ez(
  data = setFour,
  dv = "cowanC",
  id = "PID", 
  within = "DistNum",
  between = "Group"
)

setSixANOVA <- aov_ez(
  data = setSix,
  dv = "cowanC",
  id = "PID", 
  within = "DistNum",
  between = "Group"
)
#Pairwise comparisons
setSix.dist <- pairs(emmeans(setSixANOVA, ~ DistNum|Group))
setSix.group <- pairs(emmeans(setSixANOVA, ~ Group|DistNum))

interactionData <- summarySE(fixed.Vals, measurevar="D", groupvars=c("targetNum","DistNum","Group"))
interaction <- ggplot(interactionData, aes( x=DistNum,y=D, color = Group)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=D-se, ymax=D+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("acc (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()

lowANOVA <- aov_ez(
  data = lowGroup,
  dv = "D",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
lowGroup.T <- pairs(emmeans(lowANOVA, ~ targetNum))
lowGroup.D <- pairs(emmeans(lowANOVA, ~ DistNum))

lowGroupdata <- summarySE(lowGroup, measurevar="D", groupvars=c("targetNum","DistNum"))
lowGroupACC <- ggplot(lowGroupdata, aes( x=DistNum,y=D)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=D-se, ymax=D+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("acc (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()

highANOVA <- aov_ez(
  data = highGroup,
  dv = "D",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
highGroup.TxD <- pairs(emmeans(highANOVA, ~ targetNum|DistNum))
highGroup.DxT <- pairs(emmeans(highANOVA, ~ DistNum|targetNum))

highGroupdata <- summarySE(highGroup, measurevar="D", groupvars=c("targetNum","DistNum"))
highGroupACC <- ggplot(highGroupdata, aes( x=DistNum,y=D)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=D-se, ymax=D+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("acc (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
}
```

```{r capacity_group}
if (FALSE) {
capacity.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("targetNum","DistNum"),
  between = "Group"
)

lowGroup <- subset(fixed.Vals, Group=="Low")
highGroup <- subset(fixed.Vals, Group=="High")
setTwo <- subset(fixed.Vals, targetNum==2)
setFour <- subset(fixed.Vals, targetNum=4)
setSix <- subset(fixed.Vals, targetNum==6)

setTwoANOVA <- aov_ez(
  data = setTwo,
  dv = "correctResponse",
  id = "PID", 
  within = "DistNum",
  between = "Group"
)

setFourANOVA <- aov_ez(
  data = setFour,
  dv = "correctResponse",
  id = "PID", 
  within = "DistNum",
  between = "Group"
)

setSixANOVA <- aov_ez(
  data = setSix,
  dv = "correctResponse",
  id = "PID", 
  within = "DistNum",
  between = "Group"
)
#Pairwise comparisons
setSix.dist <- pairs(emmeans(setSixANOVA, ~ DistNum|Group))
setSix.group <- pairs(emmeans(setSixANOVA, ~ Group|DistNum))

interactionData <- summarySE(fixed.Vals, measurevar="correctResponse", groupvars=c("targetNum","DistNum","Group"))
interaction <- ggplot(interactionData, aes( x=DistNum,y=correctResponse, color = Group)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("acc (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
}
```

# Discussion

The number of irrelevant objects presented in the change detection task effects performance on the task.

There was little evidence of an effect of block context on individual performance.
 
Our variable distractor blocks never had 0 distractors, maybe this would boost block context effects as currenty particpiants might be maintaining a filter the entire block whereas if there were 0 distractor trials maybe they would be fluctuating between active suppression or not. While we see some differnces between distractor number in the fixed trials, the largest effects are between 0 and other blocks.

What about estimating the R across distractor number on jack knifed estimates of capacity etc. as measure of distractor effect (average of individual R is no the same as R of averaged data.)

\newpage

# References
```{r WMB_create_r-references}
r_refs(file = "r-references.bib")
```

\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}