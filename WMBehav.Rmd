---
title             : "Working memory capacity in a change detection task is effected by the number of irrelevant objects in the display"
shorttitle        : "Effects of distractor number on change detection"

author: 
  - name          : "Dion T. Henare"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "School of Psychology, University of Auckland, Private Bag 92019, Auckland 1010, New Zealand"
    email         : "dion.henare@auckland.ac.nz"
  - name          : "Paul M. Corballis"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "School of Psychology, Univeristy of Auckland"

author_note: |
  School of Psychology, University of Auckland, Private Bag 92019, Auckland 1010, New Zealand

abstract: |
  Enter abstract here. Each new line herein must be indented, like this line.
  
keywords          : "working memory capacity, change detection, delayed matching to sample, distraction, filtering"
wordcount         : "X"

bibliography      : ["WMBehav-references.bib"]

figsintext        : no
figurelist        : no
tablelist         : no
footnotelist      : no
lineno            : no
mask              : no

class             : "man"
output            : papaja::apa6_pdf
---

```{r load_packages, include = FALSE}
library("papaja")
#library(plyr)
library(dplyr)
library(ggplot2)
library(afex)
library(knitr)
library(xtable)
library(caTools) #split-half data
```

```{r helper_functions, include=FALSE, echo=FALSE}
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
    library(plyr)

    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function (x, na.rm=FALSE) {
        if (na.rm) sum(!is.na(x))
        else       length(x)
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- ddply(data, groupvars, .drop=.drop,
      .fun = function(xx, col) {
        c(N    = length2(xx[[col]], na.rm=na.rm),
          mean = mean   (xx[[col]], na.rm=na.rm),
          sd   = sd     (xx[[col]], na.rm=na.rm)
        )
      },
      measurevar
    )

    # Rename the "mean" column    
    datac <- rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval: 
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval/2 + .5, datac$N-1)
    datac$ci <- datac$se * ciMult

    return(datac)
}
```

```{r load_raw_data, incude = FALSE}
#Find all files
filePath <- "P:/dhen061/WMBehav-RawFolder/data/"
files <- list.files(path = filePath, pattern = ".csv")
#load the first one and get the variable names
allData <- read.csv(file=paste(filePath,files[1], sep=""), header=TRUE, sep=",")
allData <- subset(allData, select = c(targetColour, DistNum, matchType, targetNum, CorrAns, key_resp_2.keys, key_resp_2.rt))
#delete data so we just have a dataframe with the relevant variables
allData <- allData[0,]
#set PID to 1
pid = 1

#Loop through the files, load them , and if there are 720 (as should be the case), add the PID and append to dataframe
for (file in files){
  curData <- read.csv(file=paste(filePath,file, sep=""), header=TRUE, sep=",")
  curData <- filter(curData,  !is.na(curData$trials.thisRepN))
  curData <- subset(curData, select = c(targetColour, DistNum, matchType, targetNum, CorrAns, key_resp_2.keys, key_resp_2.rt))
  if (nrow(curData) == 720) {
    curData$PID <- pid
    allData <- rbind(allData,curData)
    pid = pid+1
  } else {
    #If file doesn't have 720 rows, print the name
    #print(file)
  }
}
```

```{r tidy_data, include = FALSE}
#Tidy the data, remove non-response trials, and calculate correct response column
allData <- filter(allData, !allData$key_resp_2.keys=="None")
allData$CorrAns <- factor(allData$CorrAns)
allData$key_resp_2.keys <- factor(allData$key_resp_2.keys)
allData$correctResponse <- as.integer(allData$CorrAns==allData$key_resp_2.keys)
#Spit half the data
sample = sample.split(allData$PID, SplitRatio = .5)
odd = subset(data, sample == TRUE)
even = subset(data, sample == FALSE)

#Participant rejection
participants <- group_by(allData,PID)
numberOfTrials <- summarise(participants, nrow=NROW(correctResponse))
#Which participants have less than 700 trials meaning over 20 non-responses
nonRespFails <- numberOfTrials$PID[numberOfTrials$nrow<695]
#remove failed participants
for (subj in 1:length(nonRespFails)) {
  allData <- allData[!allData$PID==nonRespFails[subj],]
  odd <- odd[!odd$PID==nonRespFails[subj],]
  even <- even[!odd$PID==nonRespFails[subj],]
}
#Which participnats have <60% accuracy in 2 targ 0 dist condition
easyCond <- filter(allData, targetNum==2 & DistNum==0)
easyAccuracy <- summarise(group_by(easyCond,PID), avg=mean(correctResponse))
accuracyFails <- easyAccuracy$PID[easyAccuracy$avg<0.60]
for (subj in 1:length(accuracyFails)) {
  allData <- allData[!allData$PID==accuracyFails[subj],]
  odd <- odd[!odd$PID==accuracyFails[subj],]
  even <- even[!odd$PID==accuracyFails[subj],]
}

#check remaining
summary(as.factor(allData$PID))
length(summary(as.factor(allData$PID)))
```

```{r create_measure, include = FALSE}
#Create hits column and FA column
allData$hits <- as.integer(allData$CorrAns=="m" & allData$key_resp_2.keys=="m")
allData$FA <- as.integer(allData$CorrAns=="x" & allData$key_resp_2.keys=="m")

#Create summary table
participants <- group_by(allData,PID, targetNum, DistNum)
#Get number of hits and false alarms and calculate pashlers K
#Apply loglinear approach to prevent Hit rate and FA rate of 1 or 0 (Hautus,1995)
summaryTable <- summarise(participants, correctResponse=mean(correctResponse)*100, hits=sum(hits)+0.5, fa=sum(FA)+0.5, possHits=sum(as.integer(CorrAns=="m"))+1, possFA=sum(as.integer(CorrAns=="x"))+1)
summaryTable$hitProp <- summaryTable$hits/summaryTable$possHits
summaryTable$faProp <- summaryTable$fa/summaryTable$possFA
#calculate capacity pashlers K
summaryTable$pashlerK <- summaryTable$targetNum*((summaryTable$hitProp-summaryTable$faProp)/(1-summaryTable$faProp))

#Separate fixed and variable blocks
fixNames <- c("0", "2","4","6")
fixed.Vals <- filter(summaryTable, DistNum %in% fixNames)
varNames <- c("targEqual","targOpp")
var.Vals <- filter(summaryTable, DistNum %in% varNames)
var.Vals$numDist <- ifelse(var.Vals$DistNum=="targEqual",var.Vals$targetNum,8-var.Vals$targetNum)
var.Vals$Block <- var.Vals$DistNum
#fix up factors in fix v var mat
fixVmat.Vals <- filter(summaryTable, DistNum == "targEqual" | (DistNum=="2" & targetNum==2) | (DistNum=="4" & targetNum==4)  | (DistNum=="6" & targetNum==6))
fixVmat.Vals$numDist <- fixVmat.Vals$DistNum
fixVmat.Vals$numDist[fixVmat.Vals$DistNum=="targEqual"] <- fixVmat.Vals$targetNum[fixVmat.Vals$DistNum=="targEqual"]
fixVmat.Vals$Block <- fixVmat.Vals$DistNum
levels(fixVmat.Vals$Block) <- c(levels(fixVmat.Vals$Block),"fixed")
fixVmat.Vals$Block[fixVmat.Vals$Block!="targEqual"] <- 'fixed'
fixVmat.Vals$Block <- factor(fixVmat.Vals$Block)
fixVmat.Vals$numDist <- factor(fixVmat.Vals$numDist)
#Fix up factors in fix v var opp
fixVopp.Vals <- filter(summaryTable, DistNum == "targOpp" | (DistNum=="2" & targetNum==6) | (DistNum=="4" & targetNum==4)  | (DistNum=="6" & targetNum==2))
fixVopp.Vals$numDist <- fixVopp.Vals$DistNum
fixVopp.Vals$numDist[fixVopp.Vals$DistNum=="targOpp"] <- 8-fixVopp.Vals$targetNum[fixVopp.Vals$DistNum=="targOpp"]
fixVopp.Vals$Block <- fixVopp.Vals$DistNum
levels(fixVopp.Vals$Block) <- c(levels(fixVopp.Vals$Block),"fixed")
fixVopp.Vals$Block[fixVopp.Vals$Block!="targOpp"] <- 'fixed'
fixVopp.Vals$Block <- factor(fixVopp.Vals$Block)
```

# Introduction
Woring memory is central to functioning and important for stuff like fluid intelligence, attention, IQ or whatever.

change detection tasks are popular for measuring WM capacity across individuals. (basic outline, increasing popularity, benefits).

Many variations in change detection tasks. Pashler vs Cowan.

working memory related to attention and specificaly distractor filtering things.

Estimates of capacity may be effected by the number of distractors that are presented in the change detection task - our study.

trial-to-trial context effets working memory so distractor effect may also be mediated by context - our study.

# Methods

## Participants

62 individuals participated. One participant did not complete the entire task and was therefore excluded from analysis. Five participants were deemed not to have performed the task properly (3 had over 25 non-responses, and two had less than 60% accuracy on a set size of two with no distractors). Leaving us with 56 individuals to be included in the analysis.

# Results

## Accuracy

### Fixed distractor blocks
```{r accuracy_fixedonly_targets, include=FALSE, echo=FALSE}
accuracy.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
accuracy.fixedonly.targanddist.targXdist <- pairs(emmeans(accuracy.fixedonly.targanddist.aov, ~ targetNum|DistNum))
accuracy.fixedonly.targanddist.distXtarg <- pairs(emmeans(accuracy.fixedonly.targanddist.aov, ~ DistNum|targetNum))

#Create tables
accuracy.fixedonly.targanddist.table <- apa_print(accuracy.fixedonly.targanddist.aov)
# FPairwise tables
accuracy.fixedonly.targanddist.targXdist.table <- xtable(summary(accuracy.fixedonly.targanddist.targXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracy.fixedonly.targanddist.targXdist.Table")
accuracy.fixedonly.targanddist.distXtarg.table <- xtable(summary(accuracy.fixedonly.targanddist.distXtarg), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracy.fixedonly.targanddist.distXtarg.Table")

#Create plot
accuracy.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="correctResponse", groupvars=c("targetNum","DistNum"))
accuracy.targXdist.bar <- ggplot(accuracy.targXdist.summarydata, aes( x=DistNum,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Accuracy (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracytargXdistPlot.pdf", width = 7, paper = "special")
accuracy.targXdist.bar
dev.off()
```

Interaction between target number and dist number. Set size 2 > set size 4 > set size 6. For set size 2 there are no differences between dist num blocks. For est size 4 0 is different from 4 and 6 and approaching for 2. For set size 6, 0 is diff from 4 and 6, 2 is diff from 4. Figure\ \@ref(fig:accuracytargXdistPlot)

```{r accuracy_fixedonly_targanddist_table, results = 'asis'}
apa_table(accuracy.fixedonly.targanddist.table$table, caption = "Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant accuracy in the working memory task.", escape = FALSE)
```

```{r accuracy_fixedOnly_pairwise, results = 'asis'}
print(accuracy.fixedonly.targanddist.targXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(accuracy.fixedonly.targanddist.distXtarg.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r accuracytargXdistPlot, fig.cap = "Participant accuracy as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracytargXdistPlot.pdf", auto_pdf = TRUE)
```

### Block context
#### Fixed vs targEqual
```{r accuracy_fixVopp_distractors, include=FALSE, echo=FALSE}
accuracy.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
accuracy.fixVmatch.distractors.distXblock <- pairs(emmeans(accuracy.fixVmatch.distractors.aov, ~ numDist|Block))
accuracy.fixVmatch.distractors.blockXdist <- pairs(emmeans(accuracy.fixVmatch.distractors.aov, ~ Block|numDist))

#Create tables
accuracy.fixVmatch.distractors.table <- apa_print(accuracy.fixVmatch.distractors.aov)
#Create pairwise tables
accuracy.fixVmatch.distractors.distXblock.table <- xtable(summary(accuracy.fixVmatch.distractors.distXblock), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracy.fixVmatch.distractors.distXblock.table")
accuracy.fixVmatch.distractors.blockXdist.table <- xtable(summary(accuracy.fixVmatch.distractors.blockXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracy.fixVmatch.distractors.blockXdist.table")

#Create plots
accuracy.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="correctResponse", groupvars=c("Block","numDist"))
accuracy.fixVmat.bar <- ggplot(accuracy.fixVmat.summarydata, aes( x=Block,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Accuracy (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracyfixvmatPlot.pdf", width = 7, paper = "special")
accuracy.fixVmat.bar
dev.off()
```

Interaction between block and distnum. within block type, accuracy graded with distnum. For distnum 2 targequal <fixed, no diff for distnum4 or distnum 6 Figure\ \@ref(fig:accuracyfixVmatPlot)

```{r accuracy_fixVmatch_distractors_table, results = 'asis'}
apa_table(accuracy.fixVmatch.distractors.table$table, caption = "Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant accuracy in the working memory task.", escape = FALSE)
```

```{r accuracy_fixVmat_pairwise, results = 'asis'}
print(accuracy.fixVmatch.distractors.distXblock.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(accuracy.fixVmatch.distractors.blockXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r accuracyfixVmatPlot, fig.cap = "Participant accuracy as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracyfixVmatPlot.pdf", auto_pdf = TRUE)
```

#### Fixed vs targOpp
```{r accuracy_fixVmat_distractors, include=FALSE, echo=FALSE}
accuracy.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "correctResponse",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
accuracy.fixVopp.distractors.distmain <- pairs(emmeans(accuracy.fixVopp.distractors.aov, ~ numDist))

#create table
accuracy.fixVopp.distractors.table <- apa_print(accuracy.fixVopp.distractors.aov)
#Create followup table
accuracy.fixVopp.distractors.distmain.table <- xtable(summary(accuracy.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (accuracy)", label = "tab:accuracy.fixVopp.distractors.distmain.table")

#create plot
accuracy.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="correctResponse", groupvars=c("Block","numDist"))
accuracy.fixVopp.bar <- ggplot(accuracy.fixVopp.summarydata, aes( x=Block,y=correctResponse)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=correctResponse-se, ymax=correctResponse+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Accuracy (%)",expand = c(0, 0), limits=c(0,100)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracyfixvoppPlot.pdf", width = 7, paper = "special")
accuracy.fixVopp.bar
dev.off()
```

Main effect of distnum, as distnum increases accuracy goes up (because set size is going down). Figure\ \@ref(fig:accuracyfixVoppPlot)

```{r accuracy_fixVopp_distractors_table, results = 'asis'}
apa_table(accuracy.fixVopp.distractors.table$table, caption = "Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant accuracy in the working memory task.", escape = FALSE)
```

```{r accuracy_fixVopp_pairwise, results = 'asis'}
print(accuracy.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r accuracyfixVoppPlot, fig.cap = "Participant accuracy as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_accuracyfixVoppPlot.pdf", auto_pdf = TRUE)
```
## Capacity
### Fixed distractor blocks
```{r capacity_fixedonly_targets, include=FALSE, echo=FALSE}
capacity.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "pashlerK",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
capacity.fixedonly.targanddist.targXdist <- pairs(emmeans(capacity.fixedonly.targanddist.aov, ~ targetNum|DistNum))
capacity.fixedonly.targanddist.distXtarg <- pairs(emmeans(capacity.fixedonly.targanddist.aov, ~ DistNum|targetNum))

#Create tables
capacity.fixedonly.targanddist.table <- apa_print(capacity.fixedonly.targanddist.aov)
# FPairwise tables
capacity.fixedonly.targanddist.targXdist.table <- xtable(summary(capacity.fixedonly.targanddist.targXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacity.fixedonly.targanddist.targXdist.Table")
capacity.fixedonly.targanddist.distXtarg.table <- xtable(summary(capacity.fixedonly.targanddist.distXtarg), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacity.fixedonly.targanddist.distXtarg.Table")

#Create plot
capacity.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="pashlerK", groupvars=c("targetNum","DistNum"))
capacity.targXdist.bar <- ggplot(capacity.targXdist.summarydata, aes( x=DistNum,y=pashlerK)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=pashlerK-se, ymax=pashlerK+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Capacity (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacitytargXdistPlot.pdf", width = 7, paper = "special")
capacity.targXdist.bar
dev.off()
```

Interaction between target number and dist number. Set size 2 > set size 4 > set size 6. For set size 2 there are no differences between dist num blocks. For est size 4 0 is different from 4 and 6 and approaching for 2. For set size 6, 0 is diff from 4 and 6, 2 is diff from 4. Figure\ \@ref(fig:capacitytargXdistPlot)

```{r capacity_fixedonly_targanddist_table, results = 'asis'}
apa_table(capacity.fixedonly.targanddist.table$table, caption = "Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant capacity in the working memory task.", escape = FALSE)
```

```{r capacity_fixedOnly_pairwise, results = 'asis'}
print(capacity.fixedonly.targanddist.targXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(capacity.fixedonly.targanddist.distXtarg.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r capacitytargXdistPlot, fig.cap = "Participant capacity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacitytargXdistPlot.pdf", auto_pdf = TRUE)
```

### Fixed distractor vs variable distractor blocks
#### Fixed vs targEqual
```{r capacity_fixVopp_distractors, include=FALSE, echo=FALSE}
capacity.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "pashlerK",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
capacity.fixVmatch.distractors.distXblock <- pairs(emmeans(capacity.fixVmatch.distractors.aov, ~ numDist|Block))
capacity.fixVmatch.distractors.blockXdist <- pairs(emmeans(capacity.fixVmatch.distractors.aov, ~ Block|numDist))

#Create tables
capacity.fixVmatch.distractors.table <- apa_print(capacity.fixVmatch.distractors.aov)
#Create pairwise tables
capacity.fixVmatch.distractors.distXblock.table <- xtable(summary(capacity.fixVmatch.distractors.distXblock), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacity.fixVmatch.distractors.distXblock.table")
capacity.fixVmatch.distractors.blockXdist.table <- xtable(summary(capacity.fixVmatch.distractors.blockXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacity.fixVmatch.distractors.blockXdist.table")

#Create plots
capacity.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="pashlerK", groupvars=c("Block","numDist"))
capacity.fixVmat.bar <- ggplot(capacity.fixVmat.summarydata, aes( x=Block,y=pashlerK)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=pashlerK-se, ymax=pashlerK+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Capacity (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacityfixvmatPlot.pdf", width = 7, paper = "special")
capacity.fixVmat.bar
dev.off()
```

Interaction between block and distnum. within block type, capacity graded with distnum. For distnum 2 and 4 no difference between block types. For dist 6, targEqual more accurate than fixed equivalent. Figure\ \@ref(fig:capacityfixVmatPlot)

```{r capacity_fixVmatch_distractors_table, results = 'asis'}
apa_table(capacity.fixVmatch.distractors.table$table, caption = "Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant capacity in the working memory task.", escape = FALSE)
```

```{r capacity_fixVmat_pairwise, results = 'asis'}
print(capacity.fixVmatch.distractors.distXblock.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(capacity.fixVmatch.distractors.blockXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r capacityfixVmatPlot, fig.cap = "Participant capacity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacityfixVmatPlot.pdf", auto_pdf = TRUE)
```

#### Fixed vs targOpp
```{r capacity_fixVmat_distractors, include=FALSE, echo=FALSE}
capacity.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "pashlerK",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
capacity.fixVopp.distractors.distmain <- pairs(emmeans(capacity.fixVopp.distractors.aov, ~ numDist))

#create table
capacity.fixVopp.distractors.table <- apa_print(capacity.fixVopp.distractors.aov)
#Create followup table
capacity.fixVopp.distractors.distmain.table <- xtable(summary(capacity.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (capacity)", label = "tab:capacity.fixVopp.distractors.distmain.table")

#create plot
capacity.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="pashlerK", groupvars=c("Block","numDist"))
capacity.fixVopp.bar <- ggplot(capacity.fixVopp.summarydata, aes( x=Block,y=pashlerK)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=pashlerK-se, ymax=pashlerK+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Capacity (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacityfixvoppPlot.pdf", width = 7, paper = "special")
capacity.fixVopp.bar
dev.off()
```

Main effect of distnum, as distnum increases capacity goes up (because set size is going down). Figure\ \@ref(fig:capacityfixVoppPlot)

```{r capacity_fixVopp_distractors_table, results = 'asis'}
apa_table(capacity.fixVopp.distractors.table$table, caption = "Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant capacity in the working memory task.", escape = FALSE)
```

```{r capacity_fixVopp_pairwise, results = 'asis'}
print(capacity.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r capacityfixVoppPlot, fig.cap = "Participant capacity as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_capacityfixVoppPlot.pdf", auto_pdf = TRUE)
```



## Hits
### Fixed distractor blocks
```{r hits_fixedonly_targets, include=FALSE, echo=FALSE}
hits.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "hitProp",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
hits.fixedonly.targanddist.targXdist <- pairs(emmeans(hits.fixedonly.targanddist.aov, ~ targetNum|DistNum))
hits.fixedonly.targanddist.distXtarg <- pairs(emmeans(hits.fixedonly.targanddist.aov, ~ DistNum|targetNum))

#Create tables
hits.fixedonly.targanddist.table <- apa_print(hits.fixedonly.targanddist.aov)
# FPairwise tables
hits.fixedonly.targanddist.targXdist.table <- xtable(summary(hits.fixedonly.targanddist.targXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixedonly.targanddist.targXdist.Table")
hits.fixedonly.targanddist.distXtarg.table <- xtable(summary(hits.fixedonly.targanddist.distXtarg), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixedonly.targanddist.distXtarg.Table")

#Create plot
hits.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="hitProp", groupvars=c("targetNum","DistNum"))
hits.targXdist.bar <- ggplot(hits.targXdist.summarydata, aes( x=DistNum,y=hitProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=hitProp-se, ymax=hitProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Hits (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitstargXdistPlot.pdf", width = 7, paper = "special")
hits.targXdist.bar
dev.off()
```

Interaction between target number and dist number. Set size 2 > set size 4 > set size 6. For set size 2 there are no differences between dist num blocks. For est size 4 0 is different from 4 and 6 and approaching for 2. For set size 6, 0 is diff from 4 and 6, 2 is diff from 4. Figure\ \@ref(fig:hitstargXdistPlot)

```{r hits_fixedonly_targanddist_table, results = 'asis'}
apa_table(hits.fixedonly.targanddist.table$table, caption = "Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant hits in the working memory task.", escape = FALSE)
```

```{r hits_fixedOnly_pairwise, results = 'asis'}
print(hits.fixedonly.targanddist.targXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(hits.fixedonly.targanddist.distXtarg.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r hitstargXdistPlot, fig.cap = "Participant hits as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitstargXdistPlot.pdf", auto_pdf = TRUE)
```

### Fixed distractor vs variable distractor blocks
#### Fixed vs targEqual
```{r hits_fixVopp_distractors, include=FALSE, echo=FALSE}
hits.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "hitProp",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
hits.fixVmatch.distractors.distXblock <- pairs(emmeans(hits.fixVmatch.distractors.aov, ~ numDist|Block))
hits.fixVmatch.distractors.blockXdist <- pairs(emmeans(hits.fixVmatch.distractors.aov, ~ Block|numDist))

#Create tables
hits.fixVmatch.distractors.table <- apa_print(hits.fixVmatch.distractors.aov)
#Create pairwise tables
hits.fixVmatch.distractors.distXblock.table <- xtable(summary(hits.fixVmatch.distractors.distXblock), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixVmatch.distractors.distXblock.table")
hits.fixVmatch.distractors.blockXdist.table <- xtable(summary(hits.fixVmatch.distractors.blockXdist), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixVmatch.distractors.blockXdist.table")

#Create plots
hits.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="hitProp", groupvars=c("Block","numDist"))
hits.fixVmat.bar <- ggplot(hits.fixVmat.summarydata, aes( x=Block,y=hitProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=hitProp-se, ymax=hitProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Hits (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitsfixvmatPlot.pdf", width = 7, paper = "special")
hits.fixVmat.bar
dev.off()
```

Interaction between block and distnum. within block type, hits graded with distnum. For distnum 2 and 4 no difference between block types. For dist 6, targEqual more accurate than fixed equivalent. Figure\ \@ref(fig:hitsfixVmatPlot)

```{r hits_fixVmatch_distractors_table, results = 'asis'}
apa_table(hits.fixVmatch.distractors.table$table, caption = "Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant hits in the working memory task.", escape = FALSE)
```

```{r hits_fixVmat_pairwise, results = 'asis'}
print(hits.fixVmatch.distractors.distXblock.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
print(hits.fixVmatch.distractors.blockXdist.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r hitsfixVmatPlot, fig.cap = "Participant hits as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitsfixVmatPlot.pdf", auto_pdf = TRUE)
```

#### Fixed vs targOpp
```{r hits_fixVmat_distractors, include=FALSE, echo=FALSE}
hits.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "hitProp",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
hits.fixVopp.distractors.distmain <- pairs(emmeans(hits.fixVopp.distractors.aov, ~ numDist))

#create table
hits.fixVopp.distractors.table <- apa_print(hits.fixVopp.distractors.aov)
#Create followup table
hits.fixVopp.distractors.distmain.table <- xtable(summary(hits.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (hits)", label = "tab:hits.fixVopp.distractors.distmain.table")

#create plot
hits.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="hitProp", groupvars=c("Block","numDist"))
hits.fixVopp.bar <- ggplot(hits.fixVopp.summarydata, aes( x=Block,y=hitProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=hitProp-se, ymax=hitProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Hits (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitsfixvoppPlot.pdf", width = 7, paper = "special")
hits.fixVopp.bar
dev.off()
```

Main effect of distnum, as distnum increases hits goes up (because set size is going down). Figure\ \@ref(fig:hitsfixVoppPlot)

```{r hits_fixVopp_distractors_table, results = 'asis'}
apa_table(hits.fixVopp.distractors.table$table, caption = "Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant hits in the working memory task.", escape = FALSE)
```

```{r hits_fixVopp_pairwise, results = 'asis'}
print(hits.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r hitsfixVoppPlot, fig.cap = "Participant hits as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_hitsfixVoppPlot.pdf", auto_pdf = TRUE)
```

## False Alarms
### Fixed distractor blocks
```{r fa_fixedonly_targets, include=FALSE, echo=FALSE}
fa.fixedonly.targanddist.aov <- aov_ez(
  data = fixed.Vals,
  dv = "faProp",
  id = "PID", 
  within = c("targetNum","DistNum")
)
#Pairwise comparisons
fa.fixedOnly.targets.targmain <- pairs(emmeans(fa.fixedonly.targanddist.aov, ~targetNum))

#Create tables
fa.fixedOnly.targets.table <- apa_print(fa.fixedonly.targanddist.aov)
#Create pairwise tables
fa.fixedOnly.targets.targmain.table <- xtable(summary(fa.fixedOnly.targets.targmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (fa)", label = "tab:fa.fixedOnly.targets.targmain.table")

#Create plot
fa.targXdist.summarydata <- summarySE(fixed.Vals, measurevar="faProp", groupvars=c("targetNum","DistNum"))
fa.targXdist.bar <- ggplot(fa.targXdist.summarydata, aes( x=DistNum,y=faProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=faProp-se, ymax=faProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~targetNum, labeller = as_labeller(c(`2`="Set size 2", `4`="Set size 4", `6`="Set size 6"))) +
  scale_y_continuous("Fa (%)",expand = c(0, 0)) +
  scale_x_discrete("Number of distractors") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fatargXdistPlot.pdf", width = 7, paper = "special")
fa.targXdist.bar
dev.off()
```

Interaction between target number and dist number. Set size 2 > set size 4 > set size 6. For set size 2 there are no differences between dist num blocks. For est size 4 0 is different from 4 and 6 and approaching for 2. For set size 6, 0 is diff from 4 and 6, 2 is diff from 4. Figure\ \@ref(fig:fatargXdistPlot)

```{r fa.fixedOnly.targets.table, results = 'asis'}
apa_table(fa.fixedOnly.targets.table$table, caption = "Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant fa in the working memory task.", escape = FALSE)
```

```{r fa_fixedOnly_pairwise, results = 'asis'}
print(fa.fixedOnly.targets.targmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r fatargXdistPlot, fig.cap = "Participant fa as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fatargXdistPlot.pdf", auto_pdf = TRUE)
```

### Fixed distractor vs variable distractor blocks
#### Fixed vs targEqual
```{r fa_fixVopp_distractors, include=FALSE, echo=FALSE}
fa.fixVmatch.distractors.aov <- aov_ez(
  data = fixVmat.Vals,
  dv = "faProp",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
fa.fixVmatch.distractors.distmain <- pairs(emmeans(fa.fixVmatch.distractors.aov, ~ numDist))

#Create tables
fa.fixVmatch.distractors.table <- apa_print(fa.fixVmatch.distractors.aov)
#Create pairwise tables
fa.fixVmatch.distractors.distmain.table <- xtable(summary(fa.fixVmatch.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (fa)", label = "tab:fa.fixVmatch.distractors.distmain.table")

#Create plots
fa.fixVmat.summarydata <- summarySE(fixVmat.Vals, measurevar="faProp", groupvars=c("Block","numDist"))
fa.fixVmat.bar <- ggplot(fa.fixVmat.summarydata, aes( x=Block,y=faProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=faProp-se, ymax=faProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Fa (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fafixvmatPlot.pdf", width = 7, paper = "special")
fa.fixVmat.bar
dev.off()
```

Interaction between block and distnum. within block type, fa graded with distnum. For distnum 2 and 4 no difference between block types. For dist 6, targEqual more accurate than fixed equivalent. Figure\ \@ref(fig:fafixVmatPlot)

```{r fa_fixVmatch_distractors_table, results = 'asis'}
apa_table(fa.fixVmatch.distractors.table$table, caption = "Summary of the 3 x 4 repeated measures ANOVA used to test the effects of set size and distractor number on participant fa in the working memory task.", escape = FALSE)
```

```{r fa_fixVmat_pairwise, results = 'asis'}
print(fa.fixVmatch.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r fafixVmatPlot, fig.cap = "Participant fa as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fafixVmatPlot.pdf", auto_pdf = TRUE)
```

#### Fixed vs targOpp
```{r fa_fixVmat_distractors, include=FALSE, echo=FALSE}
fa.fixVopp.distractors.aov <- aov_ez(
  data = fixVopp.Vals,
  dv = "faProp",
  id = "PID", 
  within = c("numDist", "Block")
)
#Interaction
fa.fixVopp.distractors.distmain <- pairs(emmeans(fa.fixVopp.distractors.aov, ~ numDist))

#create table
fa.fixVopp.distractors.table <- apa_print(fa.fixVopp.distractors.aov)
#Create followup table
fa.fixVopp.distractors.distmain.table <- xtable(summary(fa.fixVopp.distractors.distmain), caption = "Summary of the pairwise comparisons used to follow up the main interaction (fa)", label = "tab:fa.fixVopp.distractors.distmain.table")

#create plot
fa.fixVopp.summarydata <- summarySE(fixVopp.Vals, measurevar="faProp", groupvars=c("Block","numDist"))
fa.fixVopp.bar <- ggplot(fa.fixVopp.summarydata, aes( x=Block,y=faProp)) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=faProp-se, ymax=faProp+se), size=0.5,   
    width=.25,position=position_dodge(.9)) +
  facet_grid(~numDist, labeller = as_labeller(c(`2`="2 distractors", `4`="4 distractors", `6`="6 distractors"))) +
  scale_y_continuous("Fa (%)",expand = c(0, 0)) +
  scale_x_discrete("Block type") +
  theme_apa()
pdf("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fafixvoppPlot.pdf", width = 7, paper = "special")
fa.fixVopp.bar
dev.off()
```

Main effect of distnum, as distnum increases fa goes up (because set size is going down). Figure\ \@ref(fig:fafixVoppPlot)

```{r fa_fixVopp_distractors_table, results = 'asis'}
apa_table(fa.fixVopp.distractors.table$table, caption = "Summary of the 2 x 4 repeated measures ANOVA used to test the effects of block type and distractor number on participant fa in the working memory task.", escape = FALSE)
```

```{r fa_fixVopp_pairwise, results = 'asis'}
print(fa.fixVopp.distractors.distmain.table, comment=FALSE, caption.placement = "top", latex.environments="flushleft")
```

```{r fafixVoppPlot, fig.cap = "Participant fa as a function of set size and number of distractors present at encoding and retrieval.", fig.align = "center"}
include_graphics("C:/Users/dhen061/Desktop/ThesisWriting/Figures/WMBehav_fafixVoppPlot.pdf", auto_pdf = TRUE)
```

# Discussion


\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
```

\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}
